<!DOCTYPE html>
<html lang="zh-CN" class="no-js">

<head>
    
<title>Linux命令 Iptable</title>
<meta charset="utf-8">

<meta name="robots" content="index,nofollow">


<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="x-dns-prefetch-control" content="on">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="origin-when-cross-origin" />

<meta name="description" content="#!/bin/bash COUNTRY=&quot;cn&quot; IPTABLES=/sbin/iptables EGREP=/bin/egrep if [ &quot;$(id -u)&quot; != &quot;0&quot; ]; then echo &quot;you must be root&quot; 1&gt;&amp;2 exit 1 fi wget http://www.ipdeny.com/ipblocks/data/countries/cn.zone resetrules() { $IPTABLES -F $IPTABLES -t nat -F $IPTABLES -t mangle -F $IPTABLES -X } resetrules for c in $COUNTRY do country_file=$c.zone IPS=$($EGREP -v &quot;^#|^$&quot; $country_file) for ip in $IPS do echo &quot;blocking $ip&quot; $IPTABLES -A INPUT -s $ip -p TCP --dport 7000 -j ACCEPT done done">

<meta name="author" content=rinetd>

<meta name="baidu-site-verification" content="pCInWQYbNT" />
<meta name="google-site-verification" content="ifeWsnNpU7w8vP3ii_Cjq-P9LKw3ngVitnMWv4XmJqk" />





  
  
  
  
  
  

  








<link rel="canonical" href="../../../linux/cmd/linux-iptables/" />

<link rel="icon" href="../../../public/favicon.ico"/>
<link rel="shortcut icon" href="../../../public/favicon.ico"/>













<link rel="stylesheet" href="../../../front/css/main.min.css" >

<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">






<link rel="stylesheet" href="//cdn.bootcss.com/video.js/6.2.8/alt/video-js-cdn.min.css" />

</head>

<body class="single single-post single-format-standard col-3cm full-width topbar-enabled chrome">
    <div id="wrapper">
        <header id="header" class="top-menu-mobile-on one-mobile-menu top_menu header-ads-desktop  topbar-transparent">
    
  <nav class="nav-container group mobile-menu mobile-sticky " id="nav-mobile" data-menu-id="header-1">
    <div class="mobile-title-logo-in-header">
        <p class="site-title">
            <a class="custom-logo-link" href="" rel="home" title="Pytool | Home ">
                
                Pytool
            </a>
        </p>
    </div>
    <div class="ham__navbar-toggler-two collapsed" title="Menu" aria-expanded="false">
        <div class="ham__navbar-span-wrapper">
            <span class="line line-1"></span>
            <span class="line line-2"></span>
            <span class="line line-3"></span>
        </div>
    </div>
    <div class="nav-text">Linux命令 Iptables</div>
    <div class="nav-wrap container">
        <ul class="nav container-inner group mobile-search">
            <li>
                <form method="get" class="searchform themeform" action="https://demo-hueman.presscustomizr.com/">
                    <div>
                        <input type="text" class="search" name="s" onblur="if(this.value=='')this.value='To search type and hit enter';" onfocus="if(this.value=='To search type and hit enter')this.value='';" value="To search type and hit enter"/>
                    </div>
                </form>
            </li>
        </ul>
        <ul id="menu-topbar-menu" class="nav container-inner group">
        
            <li class="menu-item menu-item-type-custom menu-item-object-custom current-menu-item current_page_item menu-item-home ">
            <a href=" ">Home</a>
            </li>

        
            
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                
                <a  href="../../../ai/">Ai </a>
                
                                 
                            <ul class="sub-menu">
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../ai/math/">Math</a>
                                
                                            
                                        
                                </li>                
                            
                            </ul>
                        

              </li>
            
        
            
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                
                <a  href="../../../language/">Language </a>
                
                                 
                            <ul class="sub-menu">
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../language/python/">Python</a>
                                
                                            
                                                 
                                        <ul class="sub-menu">
                                            
                                                <li class="menu-item menu-item-type-custom menu-item-object-custom ">
                                                <a href="../../../language/python/scrapy/">Scrapy</a>
                                                
                                            </li>                
                                            
                                        </ul>
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../language/golang/">Golang</a>
                                
                                            
                                                 
                                        <ul class="sub-menu">
                                            
                                                <li class="menu-item menu-item-type-custom menu-item-object-custom ">
                                                <a href="../../../language/golang/hugo/">Hugo</a>
                                                
                                            </li>                
                                            
                                                <li class="menu-item menu-item-type-custom menu-item-object-custom ">
                                                <a href="../../../language/golang/goher/">Goher</a>
                                                
                                            </li>                
                                            
                                        </ul>
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../language/java/">Java</a>
                                
                                            
                                                 
                                        <ul class="sub-menu">
                                            
                                                <li class="menu-item menu-item-type-custom menu-item-object-custom ">
                                                <a href="../../../language/java/hadoop/">Hadoop</a>
                                                
                                            </li>                
                                            
                                        </ul>
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../language/awesome/">Awesome</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../language/php/">Php</a>
                                
                                            
                                                 
                                        <ul class="sub-menu">
                                            
                                                <li class="menu-item menu-item-type-custom menu-item-object-custom ">
                                                <a href="../../../language/php/magento/">Magento</a>
                                                
                                            </li>                
                                            
                                        </ul>
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../language/android/">Android</a>
                                
                                            
                                        
                                </li>                
                            
                            </ul>
                        

              </li>
            
        
            
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                
                <a  href="../../../macos/">Macos </a>
                
                        

              </li>
            
        
            
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                
                <a  href="../../../hardware/">Hardware </a>
                
                                 
                            <ul class="sub-menu">
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../hardware/rtmp/">Rtmp</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../hardware/%E8%BD%A6%E8%81%94%E7%BD%91/">车联网</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../hardware/android-%E5%BA%95%E5%B1%82/">Android-底层</a>
                                
                                            
                                        
                                </li>                
                            
                            </ul>
                        

              </li>
            
        
            
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                
                <a  href="../../../linux/">Linux </a>
                
                                 
                            <ul class="sub-menu">
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../linux/cmd/">Cmd</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../linux/shell/">Shell</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../linux/nginx/">Nginx</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../linux/ip/">Ip</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../linux/git/">Git</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../linux/haproxy/">Haproxy</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../linux/lvs/">Lvs</a>
                                
                                            
                                        
                                </li>                
                            
                            </ul>
                        

              </li>
            
        
            
        
            
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                
                <a  href="../../../frontend/">Frontend </a>
                
                                 
                            <ul class="sub-menu">
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../frontend/css/">Css</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../frontend/vue/">Vue</a>
                                
                                            
                                        
                                </li>                
                            
                            </ul>
                        

              </li>
            
        
            
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                
                <a  href="../../../devops/">Devops </a>
                
                                 
                            <ul class="sub-menu">
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../devops/docker/">Docker</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../devops/elk/">Elk</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../devops/ansible/">Ansible</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../devops/prometheus/">Prometheus</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../devops/drone/">Drone</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../devops/kubernetes/">Kubernetes</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../devops/oauth2/">OAuth2</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../devops/etcd/">Etcd</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../devops/apidoc/">Apidoc</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../devops/%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7/">系统监控</a>
                                
                                            
                                        
                                </li>                
                            
                            </ul>
                        

              </li>
            
        
            
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                
                <a  href="../../../database/">Database </a>
                
                                 
                            <ul class="sub-menu">
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../database/mysql/">Mysql</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../database/mongo/">Mongo</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../database/redis/">Redis</a>
                                
                                            
                                        
                                </li>                
                            
                            </ul>
                        

              </li>
            
        
            
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                
                <a  href="../../../windows/">Windows </a>
                
                        

              </li>
            
        
            
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                
                <a  href="../../../hacker/">Hacker </a>
                
                                 
                            <ul class="sub-menu">
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../hacker/01_%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/">01_端口扫描</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../hacker/00_%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E9%9A%A7%E9%81%93/">00_端口转发(隧道)</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../hacker/01-info-gather/">01-Info-Gather</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../hacker/02-spoof/">02-Spoof</a>
                                
                                            
                                        
                                </li>                
                            
                                <li class="menu-item menu-item-type-post_type menu-item-object-page">
                                <a href="../../../hacker/shells/">Shells</a>
                                
                                            
                                        
                                </li>                
                            
                            </ul>
                        

              </li>
            
        
            
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                
                <a  href="../../../work/">Work </a>
                
                        

              </li>
            
        
            
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                
                <a  href="../../../weixin/">Weixin </a>
                
                        

              </li>
            
        
            
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                
                <a  href="../../../edit/">Edit </a>
                
                        

              </li>
            
        
        
        <li class="item ">
                <a class="text" href="../../../series/">series</a>
        </li>
        <li class="item ">
                <a class="text" href="../../../categories/">categories</a>
        </li>
        <li class="item ">
                <a class="text" href="../../../tags/">tags</a>
        </li>
        <li class="item ">
                <a class="text" href="../../../me/">about</a>
        </li>

        
        </ul>
    </div>
  </nav>
    
  <nav class="nav-container group desktop-menu desktop-sticky " id="nav-topbar" data-menu-id="header-2">
    <div class="nav-text">Linux命令 Iptables</div>
    
    <div class="topbar-toggle-down">
        <i class="fas fa-angle-double-down" aria-hidden="true" data-toggle="down" title="Expand menu"></i>
        <i class="fas fa-angle-double-up" aria-hidden="true" data-toggle="up" title="Collapse menu"></i>
    </div>

    
    <div class="nav-wrap container">
      <ul id="menu-topbar-menu-1" class="nav container-inner group">
        <li class="menu-item menu-item-type-custom menu-item-object-custom current-menu-item current_page_item menu-item-home ">
            <a href="../../../">Home</a></li>
        
            
              
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children">
                <a href="../../../ai/">Ai </a>
                
                           
                    <ul class="sub-menu">
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../ai/math/">Math</a>
                          
                        </li>                
                      
                    </ul>
                  
              </li>
                    
        
            
              
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children">
                <a href="../../../language/">Language </a>
                
                           
                    <ul class="sub-menu">
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../language/python/">Python</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../language/golang/">Golang</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../language/java/">Java</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../language/awesome/">Awesome</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../language/php/">Php</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../language/android/">Android</a>
                          
                        </li>                
                      
                    </ul>
                  
              </li>
                    
        
            
              
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children">
                <a href="../../../macos/">Macos </a>
                
                  
              </li>
                    
        
            
              
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children">
                <a href="../../../hardware/">Hardware </a>
                
                           
                    <ul class="sub-menu">
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../hardware/rtmp/">Rtmp</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../hardware/%E8%BD%A6%E8%81%94%E7%BD%91/">车联网</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../hardware/android-%E5%BA%95%E5%B1%82/">Android-底层</a>
                          
                        </li>                
                      
                    </ul>
                  
              </li>
                    
        
            
              
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children">
                <a href="../../../linux/">Linux </a>
                
                           
                    <ul class="sub-menu">
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../linux/cmd/">Cmd</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../linux/shell/">Shell</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../linux/nginx/">Nginx</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../linux/ip/">Ip</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../linux/git/">Git</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../linux/haproxy/">Haproxy</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../linux/lvs/">Lvs</a>
                          
                        </li>                
                      
                    </ul>
                  
              </li>
                    
        
            
              
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children">
                <a href="../../../post/">Post </a>
                
                           
                    <ul class="sub-menu">
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../post/software/">Software</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../post/english/">English</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../post/seo/">Seo</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../post/life/">Life</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../post/wiki/">Wiki</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../post/basic/">Basic</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../post/reship/">Reship</a>
                          
                        </li>                
                      
                    </ul>
                  
              </li>
                    
        
            
              
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children">
                <a href="../../../frontend/">Frontend </a>
                
                           
                    <ul class="sub-menu">
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../frontend/css/">Css</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../frontend/vue/">Vue</a>
                          
                        </li>                
                      
                    </ul>
                  
              </li>
                    
        
            
              
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children">
                <a href="../../../devops/">Devops </a>
                
                           
                    <ul class="sub-menu">
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../devops/docker/">Docker</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../devops/elk/">Elk</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../devops/ansible/">Ansible</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../devops/prometheus/">Prometheus</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../devops/drone/">Drone</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../devops/kubernetes/">Kubernetes</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../devops/oauth2/">OAuth2</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../devops/etcd/">Etcd</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../devops/apidoc/">Apidoc</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../devops/%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7/">系统监控</a>
                          
                        </li>                
                      
                    </ul>
                  
              </li>
                    
        
            
              
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children">
                <a href="../../../database/">Database </a>
                
                           
                    <ul class="sub-menu">
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../database/mysql/">Mysql</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../database/mongo/">Mongo</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../database/redis/">Redis</a>
                          
                        </li>                
                      
                    </ul>
                  
              </li>
                    
        
            
              
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children">
                <a href="../../../windows/">Windows </a>
                
                  
              </li>
                    
        
            
              
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children">
                <a href="../../../hacker/">Hacker </a>
                
                           
                    <ul class="sub-menu">
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../hacker/01_%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/">01_端口扫描</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../hacker/00_%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E9%9A%A7%E9%81%93/">00_端口转发(隧道)</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../hacker/01-info-gather/">01-Info-Gather</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../hacker/02-spoof/">02-Spoof</a>
                          
                        </li>                
                        
                        <li class="menu-item menu-item-type-taxonomy menu-item-object-post_tag">
                          <a href="../../../hacker/shells/">Shells</a>
                          
                        </li>                
                      
                    </ul>
                  
              </li>
                    
        
            
              
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children">
                <a href="../../../work/">Work </a>
                
                  
              </li>
                    
        
            
              
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children">
                <a href="../../../weixin/">Weixin </a>
                
                  
              </li>
                    
        
            
              
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children">
                <a href="../../../edit/">Edit </a>
                
                  
              </li>
                    
        
       
        
        <li class="menu-item menu-item-type-post_type menu-item-object-page">
          <a href="../../../series/">series</a>
        </li>
        
        <li class="menu-item menu-item-type-post_type menu-item-object-page">
          <a href="../../../categories/">categories</a>
        </li>
        
        <li class="menu-item menu-item-type-post_type menu-item-object-page">
          <a href="../../../tags/">tags</a>
        </li>
        
        <li class="menu-item menu-item-type-post_type menu-item-object-page">
          <a href="../../../me/">about</a>
        </li>
        

        
      </ul>
      
    </div>
    
    
  
  </nav>
  

  
  

</header>

        <div class="container" id="page">
            <div class="container-inner">
                <div class="main">
                    <div class="main-inner group">
                        <div class="content">
    
        <div class="pad group page-title">
            <ul class="meta-single group">
                
                <li><span class="fa fa-folder-open"></span></li>
                
                <li class="category">
                <a href="../../../categories/linux-%E5%91%BD%E4%BB%A4/" rel="category tag">Linux 命令</a>
                </li>
                
            </ul>
        </div>

        
        <div class="pad group">
            <article class="post type-post status-publish format-standard has-post-thumbnail hentry category-lifestyle tag-classical-grid tag-masonry-grid tag-standard-list">
                <div class="post-inner group">
                        <h1 class="post-title">Linux命令 Iptables</h1>

                        <p class="post-byline">
                          by  · 2016年01月06日 · 17836 Words ·
                          ~36min reading time |
                          
                          
                          <a href="https://gitlab.com/rinetd/blog/edit/master/linux/cmd/linux-iptables.md" target="_blank">Improve on <i class="fa fa-gitlab"></i></a>
                        </p>
                    <div class="clear"></div>
                    <div class="entry themeform">
                        <div class="entry-inner">
                            
                            </br>
                            原文链接：<a target="_blank" href="../../../linux/cmd/linux-iptables/"> Linux命令 Iptables</a> 
                            </p>
                            

<pre><code class="language-sh">
#!/bin/bash

COUNTRY=&quot;cn&quot;
IPTABLES=/sbin/iptables
EGREP=/bin/egrep

if [ &quot;$(id -u)&quot; != &quot;0&quot; ]; then
   echo &quot;you must be root&quot; 1&gt;&amp;2
   exit 1
fi

wget http://www.ipdeny.com/ipblocks/data/countries/cn.zone

resetrules() {
    $IPTABLES -F
    $IPTABLES -t nat -F
    $IPTABLES -t mangle -F
    $IPTABLES -X
}

resetrules

for c in $COUNTRY
do
        country_file=$c.zone

        IPS=$($EGREP -v &quot;^#|^$&quot; $country_file)
        for ip in $IPS
        do
           echo &quot;blocking $ip&quot;
           $IPTABLES -A INPUT -s $ip  -p TCP --dport 7000 -j ACCEPT
        done
done
iptables -A INPUT -p TCP --dport 7000  -j DROP
exit 0
</code></pre>

<h2 id="根据注释删除iptables规则">根据注释删除iptables规则</h2>

<p><code>eval &quot;$(iptables -S | grep &quot;comment ${COMMENT}&quot; | sed -e 's/-A/-D/g' -e 's/^-/iptables -/g')&quot;</code></p>

<pre><code>#delete chains
eval &quot;$(iptables -S | grep &quot;INPUT-${COMMENT}&quot; | sed -e 's/-N/-X/g' -e 's/^-/iptables -/g')&quot;
</code></pre>

<pre><code class="language-sh">#!/bin/bash
# iptables -C 测试是否存在规则
function check_iptables(){
    check=$(echo $@ | sed -e 's/-A/-C/g')
    echo $check
    iptables $check ;ret=$?

    if [ &quot;$ret&quot; -eq 0 ]; then
            # exit 0;
            echo &quot;a&quot;;
    else
            echo 'b'
            #xtables-multi iptables $@;
    fi
}
IP=`grep ALL: /etc/hosts.deny | gawk -F&quot;ALL:&quot; '{print $2}' | grep -v &quot;some.host&quot; | grep -v &quot;PARANOID&quot;`
for i in $IP ;
do
	check_iptables -A INPUT -s $i -j DROP
	echo &quot;$i banned via iptables&quot;
done

</code></pre>

<h1 id="1-ipset">1. ipset</h1>

<p><a href="https://bigeagle.me/2016/02/ipset-policy-routing/" target="_blank">使用 dnsmasq 和 ipset 的策略路由 | K.I.S.S</a></p>

<p>apt-get install ipset<br />
ipset create banthis hash:net maxelem 1000000<br />
iptables -I INPUT -m set --match-set banthis src -p tcp --destination-port 80 -j DROP<br />
iptables -I INPUT -m set --match-set banthis src -p tcp --destination-port 443 -j DROP</p>

<h1 id="2-nftables">2. nftables</h1>

<p><a href="http://lesca.me/?s=iptables" target="_blank">*****Lesca技术宅</a><br />
<a href="http://drops.wooyun.org/tips/1424" target="_blank">*****Iptables入门教程</a><br />
<a href="http://www.cnblogs.com/JemBai/archive/2009/03/19/1416364.html" target="_blank">linux下IPTABLES配置详解</a><br />
<a href="http://www.cnblogs.com/ggjucheng/archive/2012/08/19/2646476.html" target="_blank">iptables的基本语法格式</a><br />
<a href="http://man.chinaunix.net/network/iptables-tutorial-cn-1.1.19.html" target="_blank">超级详细的Iptables指南</a><br />
<a href="http://freeloda.blog.51cto.com/2033581/1241545" target="_blank">iptables 详解及7层过滤</a><br />
<a href="http://seanlook.com/2014/02/23/iptables-understand/" target="_blank">iptables防火墙原理详解</a><br />
<a href="http://blog.chinaunix.net/uid-23069658-id-3162264.html" target="_blank">洞悉linux下的Netfilter&amp;iptables：内核中的ip_tables小觑</a><br />
################################################################################</p>

<h2 id="关闭-firewalld">关闭 firewalld</h2>

<p>systemctl stop firewalld.service          #停止firewall<br />
systemctl disable firewalld.service       #禁止firewall开机启动</p>

<p><code>yum install iptables-services</code>             #安装 iptables-services</p>

<p><code>vi /etc/sysconfig/iptables</code>   #编辑防火墙配置文件,如果没有该文件则执行 <code>yum install iptables-services</code></p>

<pre><code class="language-conf"># Firewall configuration written by system-config-firewall
# Manual customization of this file is not recommended.
*filter
:INPUT ACCEPT [0:0] 
:FORWARD ACCEPT [0:0] 
:OUTPUT ACCEPT [0:0] 
-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT 
-A INPUT -p icmp -j ACCEPT
-A INPUT -i lo -j ACCEPT
-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT
-A INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT 
-A INPUT -m state --state NEW -m tcp -p tcp --dport 3306 -j ACCEPT
-A INPUT -j REJECT --reject-with icmp-host-prohibited 
-A FORWARD -j REJECT --reject-with icmp-host-prohibited
COMMIT
</code></pre>

<p>/etc/rc.d/init.d/iptables save<br />
service iptables save         # 将配置保存<br />
service iptables restart</p>

<p><code>iptables -S</code> #配置保存<br />
systemctl restart iptables.service #最后重启防火墙使配置生效<br />
systemctl enable iptables.service #设置防火墙开机启动</p>

<p><a href="http://www.ipdeny.com/ipblocks/" target="_blank">国家代码编制好的 IP 地址列表IPdeny </a><br />
<a href="http://ftp.apnic.net/apnic/stats/apnic/delegated-apnic-latest" target="_blank">APNIC是管理亚太地区IP地址分配的机构</a><br />
################################################################################</p>

<h3 id="允许ping别人-但是别人ping我ping不通如何实现呢">允许ping别人，但是别人ping我ping不通如何实现呢？</h3>

<p>分析：对于ping这个协议，进来的为8（ping），出去的为0(响应).我们为了达到目的，需要8出去,允许0进来</p>

<p>在出去的端口上：iptables -A OUTPUT -p icmp --icmp-type 8 -j ACCEPT<br />
在进来的端口上：iptables -A INPUT -p icmp --icmp-type 0 -j ACCEPT</p>

<p>小扩展：对于127.0.0.1比较特殊，我们需要明确定义它</p>

<pre><code>        iptables -A INPUT -s 127.0.0.1 -d 127.0.0.1 -j ACCEPT
        iptables -A OUTPUT -s 127.0.0.1 -d 127.0.0.1 -j ACCEPT
</code></pre>

<p><code>iptables --wait -t nat -A DOCKER -p tcp -d 0/0 --dport 32777 -j DNAT --to-destination 172.17.0.3:80 ! -i docker0</code></p>

<h3 id="docker-给运行中的容器添加映射端口">DOCKER 给运行中的容器添加映射端口</h3>

<p><code>docker inspect -f '{{.NetworkSettings.IPAddress}}' mariadb</code></p>

<ol>
<li><p>DNAT 主机30006 ==&gt; docker容器3306端口 实现转发<br />
<code>iptables -t nat -A DOCKER ! -i docker0 -p tcp --dport 30006 -j DNAT --to-destination 192.168.0.2:3306</code></p></li>

<li><p>docker容器3306端口处理方式<br />
<code>iptables -A DOCKER -d 192.168.0.2/32 ! -i docker0 -o docker0 -p tcp --dport 3306 -j ACCEPT</code><br />
<code>iptables -t nat -A POSTROUTING -s 192.168.0.2/32 -d 192.168.0.2/32 -p tcp -m tcp --dport 3306 -j MASQUERADE</code></p></li>

<li><p>nat 端口转发跳板</p>

<p>单网卡通过 192.168.1.100:8081 访问 192.168.1.101:3306<br />
iptables -t nat -A PREROUTING -d 192.168.1.100 -p tcp --dport 8081 -j DNAT --to-destination 192.168.1.101:3306</p></li>
</ol>

<p>nat内网SSH转发 118.190.83.111:22 &lt;--&gt; 10.30.216.58:22</p>

<pre><code>iptables -t nat -A PREROUTING -d 118.190.83.111 -p tcp --dport 22 -j DNAT --to-destination 10.30.216.58:22
iptables -t nat -A POSTROUTING -d 10.30.216.58 -p tcp --dport 22 -j SNAT --to 10.30.183.164
</code></pre>

<p>nat 开启本机--&gt; 192.168.12.87:80 端口流量转发 192.168.12.77:8080<br />
iptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to-destination 192.168.12.77:8080<br />
iptables -t nat -A POSTROUTING -p tcp -d 192.168.12.77 --dport 8080 -j SNAT --to-source 192.168.12.87</p>

<h3 id="本机端口转发-30006-3306">本机端口转发 30006 --&gt; 3306</h3>

<p><code>iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 30006 -j REDIRECT --to-ports 3306</code><br />
<code>iptables -t nat -D PREROUTING -i eth0 -p tcp --dport 30006 -j REDIRECT --to-ports 3306</code><br />
-j REDIRECT 等价于 -j DNAT --to-destination<br />
<code>iptables -t nat -A PREROUTING -p tcp -i eth1 --dport 30006 -j DNAT --to-destination :3306</code><br />
<code>iptables -t nat -A PREROUTING -p tcp -i eth1 --dport 30006 -j DNAT --to-destination 127.0.0.1:3306</code><br />
<code>iptables -A INPUT -i eth1 -p tcp --dport 30006 -m state --state NEW,ESTABLISHED -j ACCEPT</code><br />
<code>iptables -A OUTPUT -o eth1 -p tcp --sport 30006 -m state --state ESTABLISHED -j ACCEPT</code></p>

<p>iptables -t nat -A PREROUTING -i wlan0 -p tcp --dport 80 -j DNAT --to--destination 192.168.0.109:80<br />
规则链之间的顺序</p>

<pre><code>入站：PREROUTING ==&gt; INPUT
出站：OUTPUT==&gt; POSTROUTING
转发：PREROUTING==&gt;FORWARD==&gt;POSTROUTING
</code></pre>

<p>规则链内的匹配顺序</p>

<pre><code>按顺序依次检查，匹配即停止（LOG策略例外）若找不到相匹配的规则，则按该链的默认策略处理
</code></pre>

<h3 id="receive数据包的流向">Receive数据包的流向：</h3>

<p>某个interface收到数据包 -&gt; PREROUTING (manage, nat) -&gt; route -&gt;<br />
是发送给本机的数据包?   -&gt; INPUT (manage, filter) -&gt; app<br />
不是发送给本机         -&gt; FORWARD (manage, filter) -&gt; POSTROUTING (manage, nat) -&gt; 某个interface发出</p>

<h3 id="send数据包的流向">Send数据包的流向：</h3>

<p>app发送数据包 -&gt; route -&gt; OUTPUT (manage, nat, filter) -&gt; POSTROUTING (manage, nat) -&gt; 某个interface发出</p>

<ul>
<li>Receive时判断是否是发送给本机的数据包的方法是：收到数据包的destination IP是否与本机某个interface的IP相同。<br /></li>
<li>Send的OUTPUT chain除了manage和filter以外nat表也有。nat的OUTPUT位于filter的之前，用于对从本机(app)发出的（而不是收到并FORWARD的）请求做DNAT或REDIRECT。<br /></li>
<li>Send的route阶段确定了数据包的source ip和source port。source ip和source port由app发送数据包时决定。如果app没有bind某个interface并且没有设置source ip/port，则source ip时为route使用的interface ip。<br /></li>
<li>filter表的INPUT, OUTPUT和FORWARD用来过滤数据包 -j ACCEPT /DROP<br /></li>
<li>nat表的PREROUTING用来DNAT(或REDIRECT）, POSTROUTING用来SNAT（或MASQUERADE）<br /></li>
<li>FORWARD (以及所有forward之后的chain)需要net.ipv4.ip_forward=1<br />
常见路由器NAT的iptables规则：<br />
<br /></li>
</ul>

<p>1.SNAT基于原地址的转换</p>

<pre><code>基于原地址的转换一般用在我们的许多内网用户通过一个外网的口上网的时候，这时我们将我们内网的地址转换为一个外网的IP，我们就可以实现连接其他外网IP的功能。
</code></pre>

<p>所以我们在iptables中就要定义到底如何转换：<br />
定义的样式：</p>

<pre><code>比如我们现在要将所有192.168.10.0网段的IP在经过的时候全都转换成172.16.100.1这个假设出来的外网地址：
iptables -t nat -A POSTROUTING -s 192.168.10.0/24 -j SNAT --to-source 172.16.100.1
这样，只要是来自本地网络的试图通过网卡访问网络的，都会被统统转换成172.16.100.1这个IP.
那么，如果172.16.100.1不是固定的怎么办？
我们都知道当我们使用联通或者电信上网的时候，一般它都会在每次你开机的时候随机生成一个外网的IP，意思就是外网地址是动态变换的。这时我们就要将外网地址换成 MASQUERADE(动态伪装):它可以实现自动寻找到外网地址，而自动将其改为正确的外网地址。所以，我们就需要这样设置：
     iptables -t nat -A POSTROUTING -s 192.168.10.0/24 -j MASQUERADE
     这里要注意：地址伪装并不适用于所有的地方。
</code></pre>

<p>2.DNAT目标地址转换</p>

<pre><code>对于目标地址转换，数据流向是从外向内的，外面的是客户端，里面的是服务器端通过目标地址转换，我们可以让外面的ip通过我们对外的外网ip来访问我们服务器不同的服务器，而我们的服务却放在内网服务器的不同的服务器上。

如何做目标地址转换呢？：
    iptables -t nat -A PREROUTING -d 192.168.10.18 -p tcp --dport 80 -j DNAT --todestination 172.16.100.2
    目标地址转换要做在到达网卡之前进行转换,所以要做在PREROUTING这个位置上
</code></pre>

<h3 id="snat基于原地址的转换">SNAT基于原地址的转换</h3>

<p>多个内网用户通过一个外网的口上网的时候，这时我们将我们内网的地址转换为同一个外网的IP，我们就可以实现连接其他外网IP的功能</p>

<pre><code class="language-sh">#br0是路由器internet interface
#lo0是路由器lan interface
iptables -t nat -A POSTROUTING -o br0 -j MASQUERADE
</code></pre>

<h3 id="dnat目标地址转换">DNAT目标地址转换</h3>

<pre><code class="language-sh">#A.B.C.D是路由器internet ip
iptables -t nat -A PREROUTING -d A.B.C.D --dport 3000:4000 -j DNAT --to 192.168.0.2
</code></pre>

<p>PREROUTING不能使用-o<br />
POSTROUTING不能使用-i</p>

<p>关于DNAT：</p>

<pre><code>内网 - firewall - 外网
    -&gt; SNAT -&gt;
    &lt;- Un SNAT &lt;-    
 
    &lt;- DNAT
    -&gt; Un DNAT
</code></pre>

<p>以上面为例：</p>

<p>DNAT改变量据包dst为内网地址<br />
Un DNAT还原响应的数据包src为firewall地址</p>

<p>SNAT改变量据包src为firewall地址<br />
Un SNAT还原响应的数据包dst为内网地址</p>

<p>首先是对初始数据包DNAT或SNAT，建立连接(established)后才能对返回数据包Un DNAT和Un SNAT。</p>

<p>说的有些绕 = =</p>

<p>关于REDIRECT：<br />
特殊形式的DNAT<br />
The REDIRECT target is used to redirect packets and streams to the (firewall) machine itself. It redirects the packet to the machine itself by changing the destination IP to the primary address of the incoming interface (locally-generated packets are mapped to the 127.0.0.1 address)</p>

<p>参数可以改变埠</p>

<p>-p tcp --to-port[s] 5409<br />
-p tcp --to-port[s] 4000-5409</p>

<p>DNAT，SNAT，Un DNAT， Un SNAT：<br />
DNAT也会对反向数据包自动Un DNAT。Un DNAT与SNAT之间没有关联。Un DNAT的数据包不会经过POSTROUTING，同样Un SNAT的数据包也不会经过PREROUTING（但Un DNAT在 <strong>相当于</strong> POSTROUTING chain的阶段执行，Un SNAT同理，参考下面的说明）。<br />
举一些例子。</p>

<p>用NAT在国外VPS上搭建一个twitter代理：</p>

<p>199.59.150.39是twitter.com的IP（被墙），A.B.C.D是VPS的IP。这样做之后修改本地hosts将twitter.com指向A.B.C.D即可直接访问<a href="https://twitter.com/。这种方法局限性太强，仅用于演示。" target="_blank">https://twitter.com/。这种方法局限性太强，仅用于演示。</a></p>

<h1 id="dnat的-to-destination-和-snat的-to-source可以简写成-to">DNAT的--to-destination 和 SNAT的--to-source可以简写成--to</h1>

<h1 id="通过dnat将443埠接受到的请求转发给twitter">通过DNAT将443埠接受到的请求转发给twitter</h1>

<p>iptables -t nat -A PREROUTING -p tcp --dport 443 -j DNAT --to-destination 199.59.150.39:443</p>

<h1 id="同时将src改为vps的ip-否则twitter收到的访问请求源地址还是原始客户端ip">同时将src改为VPS的IP，否则twitter收到的访问请求源地址还是原始客户端IP</h1>

<h1 id="并且由于这时twitter响应的数据包不会经过vps-无法自动反向-dnat">并且由于这时twitter响应的数据包不会经过VPS，无法自动反向 DNAT</h1>

<h1 id="而原始客户端只知道自己在和vps的ip通信-会把twitter响应的数据包丢弃-如果能收到的话">而原始客户端只知道自己在和VPS的IP通信，会把twitter响应的数据包丢弃（如果能收到的话）</h1>

<h1 id="另外-如果不snat-很多vps发给twitter的数据包可能中途就被路由器丢弃了-ip-spoofing-如linode就会丢弃这种">另外，如果不SNAT，很多VPS发给twitter的数据包可能中途就被路由器丢弃了（ip spoofing），如Linode就会丢弃这种。</h1>

<p>iptables -t nat -A POSTROUTING -p tcp --dport 443 -j SNAT --to-source A.B.C.D</p>

<p>OpenVPN服务器端的NAT规则：</p>

<h1 id="这里的192-168-0-0-24-是openvpn网段">这里的192.168.0.0/24 是OpenVPN网段</h1>

<p>iptables -t nat -A POSTROUTING -s 192.168.0.0/24 -o eth0 -j MASQUERADE</p>

<p>在网关（如路由器）上部署OpenVPN client，同时向整个局域网机器提供透明翻墙服务的NAT规则</p>

<h1 id="这里的192-168-0-0-24是局域网网段">这里的192.168.0.0/24是局域网网段</h1>

<h1 id="需要-redirect-gateway-def1-设置默认路由走vpn">需要&quot;redirect-gateway def1&quot;设置默认路由走VPN。</h1>

<h1 id="可以不加-o-tun0-视具体情况">可以不加-o tun0，视具体情况。</h1>

<p>iptables -t nat -A POSTROUTING -s 192.168.0.0/24 -o tun0 -j MASQUERADE</p>

<p>如果运行OpenVPN Client的机器只用于自己翻墙（不提供网关服务），则不需要SNAT，也不需要开启ip_forward，只需要”redirect-gateway def1″添加路由即可。<br />
################################################################################</p>

<h2 id="四表-filter-nat-mangle-raw-包含链的">四表 filter nat mangle raw  包含链的</h2>

<h2 id="五链-规则链-用来存放规则的">五链 - 规则链,用来存放规则的</h2>

<p><code>iptables -S</code> 查看配置<br />
1.五链管理<br />
iptables -F    清空链中的所有规则<br />
iptables -N    新建一个链<br />
iptables -X    删除一个自定义链,删除之前要保证次链是空的,而且没有被引用<br />
iptables -E    重命名链<br />
iptables -P    设置默认规则</p>

<p>2.规则管理<br />
iptables -A    添加一条新规则<br />
iptables -I    插入一条新规则 -I 后面加一数字表示插入到哪行<br />
iptables -D INPUT 1   删除一条新规则 -D 后面加一数字表示删除哪行 (通过 --line-numbers获取)<br />
iptables -R INPUT 1   替换一条新规则 -R 后面加一数字表示替换哪行</p>

<p>3.查看规则<br />
iptables -L    查看规则 –L 还有几个子选项如下<br />
iptables -L -n 以数字的方式显示<br />
iptables -L -v 显示详细信息<br />
iptables -L -x 显示精确信息<br />
iptables -L --line-numbers 显示行号</p>

<h2 id="查看指定链规则">查看指定链规则</h2>

<p><code>sudo iptables -t nat --list-rules --line-numbers</code></p>

<h3 id="清理-nat转发规则">清理 nat转发规则</h3>

<ol>
<li><code>sudo iptables -t nat -nL --line-numbers</code><br /></li>

<li><p><code>sudo iptables -t nat -D PREROUTING 2</code></p>

<h3 id="统计链中规则的包和流量计数-嘿嘿-看看哪些小子用的流量那么多-用tc限了他">统计链中规则的包和流量计数,嘿嘿,看看哪些小子用的流量那么多,用tc限了他。</h3>

<p><code>iptables -t nat -L -vn</code></p>

<h2 id="创建规则-rules">创建规则 rules</h2>

<p>只要是跨网卡的通讯就用 FORWARD chain<br />
iptables [ -t table] [chain] [条件匹配] [-j 目标动作或跳转]<br />
-t 表名：[Filter], NAT, Mangle, Raw 默认为Filter<br />
-p 协议 [all],tcp, udp, icmp, udplite, icmpv6,esp, ah, sctp, mh<br />
-m 对规则进行匹配(match)说明,常常跟在被追加(-A)、插入(-I)、替换(-R)的链(chain)之后</p></li>
</ol>

<h2 id="5-匹配条件">5.[匹配条件]</h2>

<p>! 用在接口名、协议名等前面,使规则的作用相反</p>

<h3 id="1-基本匹配">(1).基本匹配</h3>

<p>条件匹配也可以在 -i 前使用 [!] 取反<br />
[!] -s, --source          源地址<br />
[!] -d, --destination     目标地址 <code>-d 172.17.0.2/32</code><br />
[!] -i, --in-interface    从哪个网络接口进入,比如 <code>! -i docker0</code><br />
[!] -o, --out-interface   从哪个网络接口出去,比如 <code>-o docker0</code><br />
[!] -p, --protocol        协议{tcp|udp|icmp}<br />
[!] -f, --fragment</p>

<h4 id="dport-sport方式总结-参考点永远是执行iptables命令所在的主机">dport,sport方式总结,参考点永远是执行iptables命令所在的主机</h4>

<p>对于 INPUT 链: --dport指本地，--sport指外部。<br />
对于 OUTPUT链: --dport指外部主机端口，--sport指本机端口。</p>

<h3 id="2-扩展匹配-man-iptables-extensions-p-xxx-m-xxx">(2).扩展匹配 man iptables-extensions [-p xxx &amp;&amp; -m xxx]</h3>

<h4 id="1-p-protocol-隐含扩展匹配">1. -p, --protocol 隐含扩展匹配</h4>

<p>-p  tcp<br />
  --sport PORT[first:last] 源端口<br />
  --dport PORT[first:last] 目标端口<br />
  --tcp-flags mask comp: [mask为1的位必须匹配]</p>

<pre><code>有6种标示：SYN(synchronous建立联机) ACK(acknowledgement 确认) PSH(push传送) FIN(finish结束) RST(reset重置) URG(urgent紧急)Sequence number(顺序号码) Acknowledge number(确认号码)
tcp的标志位,只检查mask指定的标志位,是逗号分隔的标志位列表：SYN ACK FIN RST URG PSH ALL NONE
comp：此表中出现的标志位必须为1,comp中没出现,而mask中出现的,必须为0
--tcp-flags SYN,FIN,ACK,RST    SYN      第一次握手 SYN=1,FIN=0,RST=0,ACK=0 等价于 --syn
--tcp-flags SYN,FIN,ACK,RST    SYN,ACK  第二次握手 SYN=1,FIN=0,RST=0,ACK=1
--tcp-flags SYN,FIN,ACK,RST    ACK      第三次握手 SYN=0,FIN=0,RST=0,ACK=1
</code></pre>

<p>-p udp</p>

<pre><code>--sport
--dport
</code></pre>

<p>-p icmp:</p>

<pre><code>--icmp-type：报文协议的类型
0:echo-replay回显应答（ping应答）
8:echo-request回显请求（ping请求）ping出去的是8

自己ping别人：出去的是8,回来的是0  8-&gt; &lt;-0
别人ping自己：进来的是8,出去的是0  8&lt;- -&gt;0
</code></pre>

<h4 id="2-m-match-显示扩展匹配">2. -m, --match 显示扩展匹配</h4>

<p>对规则进行匹配(match)说明,常常跟在被追加(-A)、插入(-I)、替换(-R)的链(chain)之后<br />
-m comment --comment &quot;comment content&quot; 给一条iptables规则添加注释</p>

<pre><code>   Allows you to add comments (up to 256 characters) to any rule.
   --comment comment
   Example:
 `iptables -A INPUT -i eth1 -m comment --comment &quot;drop rule&quot;` # 给规则添加注释
 `iptables -L --line-number | grep -i 'drop rule'`  # 根据规则过滤注释
</code></pre>

<p>-m multiport 离散多端口匹配扩展(最多使用15个）</p>

<pre><code> [!] --ports port[,port|,port:port]...
 [!] --source-ports,--sports port[,port|,port:port]...
 [!] --destination-ports,--dports port[,port|,port:port]...
 -m multiport --sports 53,1024:65535 would therefore match ports 53 and all from 1024 through 65535.
</code></pre>

<p>-m iprange指定IP地址段（指定地址池），也可以取反“！”</p>

<pre><code> --src-range
 --dst-range
</code></pre>

<p>-m connlimit: 限制并发数</p>

<pre><code>！--connmilit-above n: 将单IP的并发设置为6；会误杀使用NAT上网的用户，可以根据实际情况增大该值；
`iptables -I INPUT -p tcp --dport 1024:10240 -m connlimit --connlimit-above 15 -j DROP`
`iptables -I OUTPUT -p tcp --dport 1024:10240 -m connlimit --connlimit-above 15 -j DROP`
</code></pre>

<p>-m limit: 限制连接速度</p>

<pre><code>--limit 500/s 表示每秒500次; 1/m 则为每分钟一次;      rate/[second|minute|hour|day]
--limit-burst number 表示允许触发 limit 限制的最大次数 (预设5) --limit-burst number
limit-burst是个初始值..匹配次数过了这个初始值，之后的就由limit xxx/s来控制了
这里“limit”这个词准确说，应该是“按一定速率去匹配”,至于“限制”还是“放行”是后面 -j 动作来实现的,limit 仅仅是个 match 模块，他的功能是匹配，匹配方式是按一定速率.用iptables的limit模块,目标是ACCEPT.当你设置300/s时,它大约每3ms发出一个令牌,获得令牌的包可以发出去,没有获得令牌的包只能等待下一个令牌到来,这样不会造成一些包丢失,更不会造成所谓“断线”的
`iptables -A INPUT -p tcp --dport 80 -m limit --limit 10/s -j ACCEPT`
`iptables -A INPUT -p tcp --dport 80 -j DROP`

限速
iptables -A FORWARD -m limit -d 208.8.14.53 --limit 700/s --limit-burst 100 -j ACCEPT 
iptables -A FORWARD -d 208.8.14.53 -j DROP

取消iptables限速：
iptables -D FORWARD -m limit -d 208.8.14.53 --limit 700/s --limit-burst 100 -j ACCEPT 
iptables -D FORWARD -d 208.8.14.53 -j DROP
</code></pre>

<p>-m lenth 匹配数据包的长度</p>

<pre><code>`-m length --length 1139 `
`ping -c 1 -s 1111 192.168.33.78` 向目标发送一个长度为 1111 的 ICMP 数据包（加上包头28，总长度实际为1139）
</code></pre>

<p>-m string 限定用户访问的字符串</p>

<pre><code>--algo:字符算法{bm|kmp} bm 后查法 优于 kmp算法
--string：匹配哪个字符串
`-m string --algo bm --string &quot;passwd&quot;`  匹配字符串
</code></pre>

<p>-m recent</p>

<pre><code>    # 端口复用链
    iptables -t nat -N SSH
    # 端口复用规则
    iptables -t nat  -A SSH -p tcp -j REDIRECT --to-port 22

    # 开启开关
    iptables -A INPUT -p tcp -m string --string 'coming' --algo bm -m recent --set --name letmein --rsource -j ACCEPT
    # 关闭开关
    iptables -A INPUT -p tcp -m string --string 'leaving' --algo bm -m recent --name letmein --remove -j ACCEPT

    # let's do it
    iptables -t nat -A PREROUTING -p tcp --dport 80 --syn -m recent --rcheck --seconds 3600 --name letmein --rsource -j LETMEIN

    开启复用，开启后本机到目标 80 端口的流量将转发至目标的 SSH，80 将无法再被本机访问：
    echo threathuntercoming | socat - tcp:192.168.33.78:80
</code></pre>

<p>-m mac --mac-source xx:xx:xx:xx:xx:xx 匹配源MAC地址为</p>

<p>-m time --timestart 8:00 --timestop 12:00  表示从哪个时间到哪个时间段<br />
-m time --days    表示那天<br />
-m layer7 --l7proto qq   表示匹配腾讯qq的 当然也支持很多协议,这个默认是没有的,需要我们给内核打补丁并重新编译内核及iptables才可以使用<br />
-m conntrack：对下列连接通信与当前的包/连接进行匹配。 conntrack模块可以根据先前的连接来确定数据包之间的关系<br />
  -ctstate ESTABLISHED, RELATED：规则将应用到的连接状态。<br />
  在本例中，ESTABLISHED 连接代表能够看到两个方向数据包的连接，<br />
  而 RELATED 类型代表，数据包开启一个新连接，但是与现有连接相关联。<br />
<code>iptables -m conntrack --help</code> conntrack模块会在以后的版本中取代state,state是简化版<br />
-m state --state   匹配状态的，结合ip_conntrack追踪会话的状态，ip状态有四种</p>

<pre><code>    NEW：          新连接请求
    ESTABLISHED：  已建立的连接
    RELATED：      相关联的
    INVALID：      非法连接
-m state --state NEW -j ACCEPT 状态为NEW的放行
-m state --state NEW,ESTABLISHED -j ACCEPT 状态为NEW、ESTABLISHED的都放行

NEW：该包想要开始一个连接（重新连接或将连接重定向）
RELATED：该包是属于某个已经建立的连接所建立的新连接。例如：FTP的数据传输连接就是控制连接所 RELATED出来的连接。--icmp-type 0 ( ping 应答) 就是--icmp-type 8 (ping 请求)所RELATED出来的。
ESTABLISHED ：只要发送并接到应答，一个数据连接从NEW变为ESTABLISHED,而且该状态会继续匹配这个连接的后续数据包。
INVALID：数据包不能被识别属于哪个连接或没有任何状态比如内存溢出，收到不知属于哪个连接的ICMP错误信息，一般应该DROP这个状态的任何数据。
</code></pre>

<h4 id="iptables的几个状态-state">IPTABLES的几个状态 state</h4>

<p>这个模块在iptables下的使用叫做state,而在Netfilter机制中是以xt_state.ko文件存在。在TCP/IP规范中连接状态共划分为十二种,但在state模块的描述下却只有四种,分别是ESTABLISHED、NEW、RELATED及INVALID,这两个分类是两个不相干的定义。例如在TCP/IP标准描述下UDP及ICMP数据包是没有连接状态的,但在state模块的描述下,任何数据包都有连接状态。</p>

<ol>
<li><p>NEW          [新创建连接请求SYNC]<br />
当你在使用UDP、TCP、ICMP等协议时,发出的第一个包的状态就是“NEW”,NEW与协议无关<br />
首先我们知道,NEW与协议无关,其所指的是每一条连接中的第一个数据包,</p></li>

<li><p>ESTABLISHED  <a href="1" target="_blank">已建立的连接</a>与TCP数据包的关系：首先在防火墙主机上执行SSH Client,并且对网络上的SSH服务器提出服务请求,而这时送出的第一个数据包就是服务请求的数据包,如果这个数据包能够成功的穿越防火墙,那么接下来SSH Server与SSH Client之间的所有SSH数据包的状态都会是ESTABLISHED。</p></li>
</ol>

<p>(2)与UDP数据包的关系：假设我们在防火墙主机上用firefox应用程序来浏览网页（通过域名方式）,而浏览网页的动作需要DNS服务器的帮助才能完成,因此firefox会送出一个UDP数据包给DNS Server,以请求名称解析服务,如果这个数据包能够成功的穿越防火墙,那么接下来DNS Server与firefox之间的所有数据包的状态都会是ESTABLISHED。<br />
(3)与ICMP数据包的关系：假设我们在防火墙主机ping指令来检测网络上的其他主机时,ping指令所送出的第一个ICMP数据包如果能够成功的穿越防火墙,那么接下来刚才ping的那个主机与防火墙主机之间的所有ICMP数据包的状态都会是ESTABLISHED。<br />
由以上的解释可知,只要数据包能够成功的穿越防火墙,那么之后的所有数据包（包含反向的所有数据包）状态都会是ESTABLISHED。</p>

<ol>
<li><p>RELATED     [相关联的连接]<br />
RELATED状态的数据包是指被动产生的数据包。而且这个连接是不属于现在任何连接的。RELATED状态的数据包与协议无关,只要回应回来的数据包是因为本机送出一个数据包导致另一个连接的产生,而这一条新连接上的所有数据包都是属于RELATED状态的数据包。</p></li>

<li><p>INVALID    [非法连接,其他]<br />
INVALID状态是指状态不明的数据包,也就是不属于以上三种状态的封包。这类包一般会被视为恶意包而被丢弃。凡是属于INVALID状态的数据包都视为恶意的数据包,因此所有INVALID状态的数据包都应丢弃掉,匹配INVALID状态的数据包的方法如下：<br />
iptables -A INPUT -p all -m state INVALID -j DROP<br />
我们应将INVALID状态的数据包放在第一条。</p></li>
</ol>

<h2 id="6-处理动作">6.处理动作</h2>

<p>-j ACCEPT     允许<br />
-j REJECT     拒绝<br />
-j DROP       拒绝并提示信息<br />
-j SNAT       源地址转换<br />
-j DNAT       目标地址转换<br />
-j REDIRECT   重定向<br />
-j MASQUERAED  地址伪装<br />
-j LOG --log-prefix &quot;说明信息,自己随便定义&quot;      记录日志</p>

<p>常用的处理动作：<br />
-j 参数用来指定要进行的处理动作,常用的处理动作包括：ACCEPT、REJECT、DROP、REDIRECT、MASQUERADE、LOG、DNAT、SNAT、MIRROR、QUEUE、RETURN、MARK。</p>

<ol>
<li>ACCEPT 将数据包放行,进行完此处理动作后,将不再比对其它规则,直接跳往下一个规则链（natostrouting）。<br /></li>
<li>REJECT 拦阻该数据包,并传送数据包通知对方,可以传送的数据包有几个选择：ICMP port-unreachable、ICMP echo-reply 或是tcp-reset（这个数据包会要求对方关闭联机）,进行完此处理动作后,将不再比对其它规则,直接 中断过滤程序。 范例如下：<br />
<code>iptables -A FORWARD -p TCP --dport 22 -j REJECT --reject-with tcp-reset</code><br /></li>
<li>DROP 丢弃包不予处理,进行完此处理动作后,将不再比对其它规则,直接中断过滤程序。<br /></li>

<li><p>LOG 将封包相关讯息纪录在 /var/log 中,详细位置请查阅 /etc/syslog.conf 配置文件,进行完此处理动作后,将会继续比对其规则。例如：<br />
<code>iptables -A INPUT -p tcp -j LOG --log-prefix &quot;INPUT packets&quot;</code></p></li>

<li><p>SNAT 改写封包来源 IP 为某特定 IP 或 ip-ip 范围,可以指定 port 对应的范围,进行完此处理动作后,将直接跳往下一个规则（mangleostrouting）。范例如下：<br />
--to-source [ipaddr[-ipaddr]][:port[-port]]<br />
--random<br />
--random-fully<br />
--persistent<br />
<code>iptables -t nat -A POSTROUTING -p tcp -o eth0 -j SNAT --to-source 194.236.50.155-194.236.50.160:1024-32000</code></p></li>

<li><p>MASQUERADE 改写数据包来源 IP为防火墙 NIC IP,可以指定 port 对应的范围,进行完此处理动作后,直接跳往下一个规则（mangleostrouting）。这个功能与 SNAT 略有不同,当进行 IP 伪装时,不需指定要伪装成哪个 IP,IP 会从网卡直接读取,当使用拨号连接时,IP 通常是由 ISP 公司的 DHCP 服务器指派的,这个时候 MASQUERADE 特别有用。算是snat中的一种特例，可以实现自动化的snat<br />
--to-ports port[-port]<br />
--random<br />
<code>iptables -t nat -A POSTROUTING -p TCP -j MASQUERADE --to-ports 1024-31000</code><br />
<code>iptables -t nat -A POSTROUTING -s 172.17.0.0/16 ! -o docker0 -j MASQUERADE</code><br />
修改源ip地址的目的一般都是为了让这个包能再回到自己这里，所以在iptables中，SNAT是在出口，也即POSTROUTING链发挥作用。</p></li>
</ol>

<p>修改目的ip地址的原因一般就是为了改变包发送的目的地，让包走出去，所以在iptables中，DNAT是在入口，也即PREROUTING链中发挥作用，以便让包进入FORWARD表。</p>

<ol>
<li><p>DNAT 改写封包目的地 IP 为某特定 IP 或 IP 范围,可以指定 port 对应的范围,进行完此处理动作后,将会直接跳往下一个规炼（filter:input 或 filter:forward）。范例如下：<br />
--to-destination [ipaddr[-ipaddr]][:port[-port]]<br />
--persistent<br />
--random<br />
<code>iptables -t nat -A PREROUTING -p tcp -d 15.45.23.67 --dport 80 -j DNAT --to-destination 192.168.1.1-192.168.1.10:80-100</code><br />
每个流都会被随机分配一个要转发到的地址，但同一个流总是使用同一个地址</p></li>

<li><p>REDIRECT 将包重新导向到另一个端口（PNAT）,进行完此处理动作后,将会继续比对其它规则。 这个功能可以用来实作通透式porxy 或用来保护 web 服务器。例如：DNAT的一种特殊形式,将网络包转发到本地host上（不管IP头部指定的目标地址是啥）[端口转发]<br />
--to-ports port[-port]<br />
--random<br />
<code>iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-ports 8080</code></p></li>

<li><p>MIRROR 镜像数据包,也就是将来源 IP 与目的地 IP 对调后,将数据包送回,进行完此处理动作后,将会中断过滤程序。</p></li>

<li><p>QUEUE 中断过滤程序,将数据包放入队列,交给其它程序处理。透过自行开发的处理程序,可以进行其它应用,例如：计算联机费.......等。<br />
--queue-num value<br />
--queue-balance value:value<br />
--queue-bypass<br />
--queue-cpu-fanout</p></li>

<li><p>RETURN 结束在目前规则链中的过滤程序,返回主规则链继续过滤,如果把自订规则链看成是一个子程序,那么这个动作,就相当提早结束子程序并返回到主程序中。<br />
MARK 将数据包标上某个代号,以便提供作为后续过滤的条件判断依据,进行完此处理动作后,将会继续比对其它规则。范例如下：<br />
<code>iptables -t mangle -A PREROUTING -p tcp --dport 22 -j MARK --set-mark 2</code></p></li>
</ol>

<p>1.1 filter、nat、mangle等规则表</p>

<p>filter表</p>

<p>主要用于对数据包进行过滤，根据具体的规则决定是否放行该数据包（如DROP、ACCEPT、REJECT、LOG）。filter 表对应的内核模块为iptable_filter，包含三个规则链：</p>

<pre><code>INPUT链：INPUT针对那些目的地是本地的包
FORWARD链：FORWARD过滤所有不是本地产生的并且目的地不是本地(即本机只是负责转发)的包
OUTPUT链：OUTPUT是用来过滤所有本地生成的包
</code></pre>

<p>nat表</p>

<p>主要用于修改数据包的IP地址、端口号等信息（网络地址转换，如SNAT、DNAT、MASQUERADE、REDIRECT）。属于一个流的包(因为包<br />
的大小限制导致数据可能会被分成多个数据包)只会经过这个表一次。如果第一个包被允许做NAT或Masqueraded，那么余下的包都会自动地被做相同的操作，也就是说，余下的包不会再通过这个表。表对应的内核模块为 iptable_nat，包含三个链：</p>

<pre><code>PREROUTING链：作用是在包刚刚到达防火墙时改变它的目的地址
OUTPUT链：改变本地产生的包的目的地址
POSTROUTING链：在包就要离开防火墙之前改变其源地址
</code></pre>

<p>mangle表</p>

<p>主要用于修改数据包的TOS（Type Of Service，服务类型）、TTL（Time To Live，生存周期）指以及为数据包设置Mark标记，以实现Qos(Quality Of Service，服务质量)调整以及策略路由等应用，由于需要相应的路由设备支持，因此应用并不广泛。包含五个规则链——PREROUTING，POSTROUTING，INPUT，OUTPUT，FORWARD。</p>

<p>raw表</p>

<p>是自1.2.9以后版本的iptables新增的表，主要用于决定数据包是否被状态跟踪机制处理。在匹配数据包时，raw表的规则要优先于其他表。包含两条规则链——OUTPUT、PREROUTING</p>

<p>iptables中数据包和4种被跟踪连接的4种不同状态：</p>

<pre><code>NEW：该包想要开始一个连接（重新连接或将连接重定向）
RELATED：该包是属于某个已经建立的连接所建立的新连接。例如：FTP的数据传输连接就是控制连接所 RELATED出来的连接。--icmp-type 0 ( ping 应答) 就是--icmp-type 8 (ping 请求)所RELATED出来的。
ESTABLISHED ：只要发送并接到应答，一个数据连接从NEW变为ESTABLISHED,而且该状态会继续匹配这个连接的后续数据包。
INVALID：数据包不能被识别属于哪个连接或没有任何状态比如内存溢出，收到不知属于哪个连接的ICMP错误信息，一般应该DROP这个状态的任何数据。
</code></pre>

<p>1.2 INPUT、FORWARD等规则链和规则</p>

<p>在处理各种数据包时，根据防火墙规则的不同介入时机，iptables供涉及5种默认规则链，从应用时间点的角度理解这些链：</p>

<pre><code>INPUT链：当接收到防火墙本机地址的数据包（入站）时，应用此链中的规则。
OUTPUT链：当防火墙本机向外发送数据包（出站）时，应用此链中的规则。
FORWARD链：当接收到需要通过防火墙发送给其他地址的数据包（转发）时，应用此链中的规则。
PREROUTING链：在对数据包作路由选择之前，应用此链中的规则，如DNAT。
POSTROUTING链：在对数据包作路由选择之后，应用此链中的规则，如SNAT。
</code></pre>

<p>--&gt;PREROUTING--&gt;[ROUTE]--&gt;FORWARD--&gt;POSTROUTING--&gt;</p>

<pre><code> mangle        |       mangle        ^ mangle
  nat          |       filter        |  nat
               |                     |
               |                     |
               v                     |
             INPUT                 OUTPUT
               | mangle              ^ mangle
               | filter              |  nat
               v ------&gt;local-------&gt;| filter
</code></pre>

<p>其中中INPUT、OUTPUT链更多的应用在“主机防火墙”中，即主要针对服务器本机进出数据的安全控制；而FORWARD、PREROUTING、POSTROUTING链更多的应用在“网络防火墙”中，特别是防火墙服务器作为网关使用时的情况。</p>

<p>################################################################################<br />
<img src="http://img1.51cto.com/attachment/201307/173142806.png" alt="数据包过滤匹配流程" /><br />
数据包流向:<br />
从网卡 eth0 --&gt;经过Iptables及route --&gt; docker0<br />
INPUT链 – 处理来自外部的数据。<br />
FORWARD链 – 将数据转发到本机的其他网卡设备上。<br />
OUTPUT链 – 处理向外发送的数据。</p>

<p>#数据包过滤匹配流程<br />
Chains 发生的时机:<br />
PREROUTING  数据包进入本机后,进入Route Table前<br />
INPUT       数据包通过Route Table后,目地为本机<br />
OUTPUT      由本机发出,进入Route Table前<br />
FORWARD     通过Route Table后,目地不是本机时<br />
POSTROUTING 通过Route Table后,送到网卡前</p>

<p>四表:优先级高-&gt;低 表遍历先后顺序为:[raw--&gt;mangle--&gt;nat--&gt;filter]<br />
-t filer 可以省略不写<br />
五链：</p>

<h3 id="1-prerouting-从上到下">1. PREROUTING (从上到下)</h3>

<p>-t raw    -I PREROUTING<br />
-t mangle -I PREROUTING<br />
-t nat    -I PREROUTING [常用DNAT]</p>

<h4 id="input-route-table">Input Route Table</h4>

<p>此处有入口路由选择 从PREROUTING分叉到[INPUT|FORWARTD]</p>

<h3 id="2-input-从下到上">2. INPUT (从下到上)</h3>

<p>-t filter -I INPUT      [常用DROP]<br />
-t mangle -I INPUT</p>

<h3 id="3-forward-从上到下">3. FORWARD (从上到下)</h3>

<p>-t mangle -I FORWARD<br />
-t filter -I FORWARD   [常用ip_forward]</p>

<h4 id="output-route-table">Output Route Table</h4>

<p>此处有出口路由选择[Output Route Table] 进入OUTPUT链</p>

<h3 id="4-output-从上到下">4. OUTPUT (从上到下)</h3>

<p>-t raw    -I OUTPUT<br />
-t mangle -I OUTPUT<br />
-t nat    -I OUTPUT<br />
-t filter -I OUTPUT</p>

<h3 id="5-postrouting-从上到下">5. POSTROUTING (从上到下)</h3>

<p>-t mangle -I POSTROUTING<br />
-t nat    -I POSTROUTING [常用SNAT]</p>

<p><img src="http://i.stack.imgur.com/YkwUi.png" alt="数据报流" /><br />
<img src="http://hi.csdn.net/attachment/201112/13/0_1323742526q6XX.gif" alt="数据报流" /><br />
################################################################################<br />
#清空 filter table<br />
[root@localhost]# iptables -F<br />
[root@localhost]# iptables -X<br />
[root@localhost]# iptables -Z</p>

<p>#配置(filter)表默认链策略<br />
iptables -P INPUT DROP<br />
iptables -P FORWARD DROP<br />
iptables -P OUTPUT DROP</p>

<p>#允许回环接口(lo),默认accept<br />
iptables -A INPUT -i lo -j ACCEPT<br />
iptables -A INPUT -p ALL -i lo -j ACCEPT<br />
#允许所有已经建立的和相关的连接<br />
iptables-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT<br />
iptables-A OUTPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</p>

<p>#drop非法连接<br />
iptables -A INPUT     -m state --state INVALID -j DROP<br />
iptables -A OUTPUT    -m state --state INVALID -j DROP<br />
iptables -A FORWARD -m state --state INVALID -j DROP</p>

<p>#允许ICMP接受ping<br />
/sbin/iptables -A INPUT -p icmp -m icmp --icmp-type 8 -j ACCEPT<br />
################################ RAW ##########################################</p>

<h2 id="iptables-raw表">iptables raw表</h2>

<p>RAW表作用:Raw表的引入可以分离出不需要被conntrack的流量<br />
4个表的优先级由高到低的顺序为:raw--&gt;mangle--&gt;nat--&gt;filter<br />
举例来说:如果PRROUTING链上,即有mangle表,也有nat表,那么先由mangle处理,然后由nat表处理</p>

<p>RAW表只使用在PREROUTING链和OUTPUT链上,因为优先级最高,从而可以对收到的数据包在连接跟踪前进行处理。一但用户使用了RAW表,在某个链上,RAW表处理完后,将跳过NAT表和 ip_conntrack处理,即不再做地址转换和数据包的链接跟踪处理了.</p>

<p>RAW表可以应用在那些不需要做nat的情况下,以提高性能。如大量访问的web服务器,可以让80端口不再让iptables做数据包的链接跟踪处理,以提高用户的访问速度。</p>

<p>################################ NAT ##########################################</p>

<h1 id="iptables的nat表">iptables的NAT表</h1>

<pre><code>SNAT - Source NAT,扮演网关角色的机器和其他机器共享一个网络连接时使用,
MASQUERADE - SNAT的一种特殊形式,适用于像adsl这种临时会变的ip上
DNAT - Destination NAT,将网络内部服务细节掩藏起来
REDIRECT - DNAT的一种特殊形式,将网络包转发到本地host上（不管IP头部指定的目标地址是啥）
</code></pre>

<h2 id="sysctl开启ip-forward">sysctl开启ip_forward</h2>

<h3 id="查看开启状态">查看开启状态</h3>

<p><code>sysctl net.ipv4.ip_forward</code><br />
cat /proc/sys/net/ipv4/ip_forward</p>

<h3 id="永久生效">永久生效</h3>

<p>vi /etc/sysctl.conf</p>

<pre><code>`net.ipv4.ip_forward = 1`
</code></pre>

<p>sysctl -p /etc/sysctl.conf</p>

<h4 id="临时生效">临时生效</h4>

<p>sysctl net.ipv4.ip_forward=1<br />
  sysctl -w net.ipv4.ip_forward=1<br />
  echo 1 &gt; /proc/sys/net/ipv4/ip_forward</p>

<ul>
<li><p>SNAT最主要是用在本地机器作为网关时,和其他机器共享网络连接是使用。比如,我们常见的pptp或者openvpn服务器:<br />
SNAT的目的是IP包经过route之后、出本地的网络栈之前,将源地址改成本机的（否则192.168.0.2机器响应请求的返回地址就不对）, 所以在POSTROUTING链。<br />
假设vpn网段是192.168.0.1/24<br />
本地机器外网ip是a.d.c.d<br />
vpn网口为tun0. 那么需要:<br />
```bash</p>

<h1 id="将来自于192-168-0-1-24-网段的流量通过外网a-b-c-d出口出去">将来自于192.168.0.1/24 网段的流量通过外网a.b.c.d出口出去</h1>

<p>iptables -t nat -A POSTROUTING -s 192.168.0.1/24 SNAT --to-destination a.b.c.d<br />
如果是动态ip,则第一句话需要改成：<br />
<code>iptables -t nat -A POSTROUTING -s 192.168.0.1/24 MASQUERADE</code></p></li>
</ul>

<h1 id="forward链相应设置打开">FORWARD链相应设置打开</h1>

<p>iptables -A FORWARD -i eth0 -o tun0 -m state -state RELATED,ESTABLISHED -j ACCEPT<br />
iptables -A FORWARD -i tun0 -o eth0 -j ACCEPT</p>

<pre><code>
+ DNAT主要用在网络内部的机器提供服务,但是又不想暴露在网络上,那么需要在一台足够安全、可以暴露在互联网上的机器来提供NAT服务。
比如本地机器有公网ip：1.1.1.1, 内网ip：192.168.0.1
内网另一台机器192.168.0.2:8080 提供了web服务。
我们可以做DNAT使得看起来访问1.1.1.1:80的时候,就跟访问192.168.0.1:8080一样：

```bash
iptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to-destination 192.168.0.2:8080
# 关键一步,需要加上SNAT
iptables -t nat -A POSTROUTING -d 192.168.0.2 --dport 8080 -j SNAT --to-source 1.1.1.1
</code></pre>

<p>这里面其实就是做了端口转发, 将本机1.1.1.1:80端口转发到192.168.0.2:8080端口<br />
DNAT是在进入路由层面的route之前,将IP包中的目的地址改掉,所以是PREROUTING链起作用</p>

<ul>
<li><p>MASQUERADE  适用场景 网关IP动态变化。<br />
假如当前系统用的是ADSL/3G/4G动态拨号方式,那么每次拨号,出口IP都会改变,SNAT就会有局限性。<br />
iptables -t nat -A POSTROUTING -s 192.168.0.0/24 -o eth0 -j MASQUERADE<br />
重点在那个『 MASQUERADE 』！这个设定值就是『IP伪装成为封包出去(-o)的那块装置上的IP』！不管现在eth0的出口获得了怎样的动态ip,MASQUERADE会自动读取eth0现在的ip地址然后做SNAT出去,这样就实现了很好的动态SNAT地址转换。</p></li>

<li><p>REDIRECT是DNAT的一个特例。方便在本机做端口转发。<br />
比如你有一个Squid这样的HTTP代理,监听网关的8888端口。那么你可以如下设置将它做成一个透明代理：<br />
iptables -t nat -A PREROUTING -i eth0(假设从eth0进流量)  -p tcp --dport 80 -j REDIRECT  --to-port 8888<br />
这么做相当于将80端口的流量劫持到8888,并且不会被用户察觉</p></li>
</ul>

<h2 id="linux-网关">Linux 网关</h2>

<h2 id="共享上网-nat">共享上网(nat)</h2>

<p>目标：使局域网的用户都可以通过Iptables网关访问外网的服务器</p>

<p>[root@localhost]# echo 1 &gt; /proc/sys/net/ipv4/ip_forward<br />
  [root@localhost]# iptables -t nat -A POSTROUTING -o ppp0 -j MASQUERADE</p>

<p>说明: SNAT 和 MASQUERADE 区别<br />
SNAT : 不管是几个地址,必须明确的指定要SNAT的ip,适合网关服务器有固定地址或者是固定地址范围.<br />
MASQUERADE : PNAT是针对ADSL动态拨号这种场景而设计,从服务器的网络接口上,自动获取当前ip地址来做NAT,这样就实现了动态SNAT地址转换</p>

<p>3.3. 内网的服务器对外服务(端口映射)</p>

<p>目标：使外网用户可以访问到局域网192.168.138.21这台HTTP服务</p>

<p>[root@localhost]# echo 1 &gt; /proc/sys/net/ipv4/ip_forward<br />
  [root@localhost]# iptables -t nat -A PREROUTING -p tcp -m tcp --dport 80 -j DNAT --to-destination 192.168.138.21<br />
  [root@localhost]# iptables -t nat -A POSTROUTING -o ppp0 -j MASQUERADE</p>

<p>3.4. 在网关服务器进行透明代理</p>

<p>目标: 使局域网用户,访问外网web服务时,自动使用squid作web透明代理服务器。<br />
  [root@localhost]# echo 1 &gt; /proc/sys/net/ipv4/ip_forward<br />
  [root@localhost]# iptables -t nat -A PREROUTING -s 192.168.138.0/24 -p tcp --dport 80 -i eth0 -j DNAT --to 192.168.138.1<br />
  [root@localhost]# iptables -t nat -A PREROUTING -s 192.168.138.0/24 -p tcp --dport 80 -i eth0 -j REDIRECT --to 3128<br />
  [root@localhost]# iptables -t nat -A POSTROUTING -o ppp0 -j MASQUERADE</p>

<h1 id="在服务端拦截响应">在服务端拦截响应：</h1>

<p>iptables -A OUTPUT -d 10.16.15.109 -j DROP</p>

<h1 id="禁止与211-101-46-253的所有连接">禁止与211.101.46.253的所有连接</h1>

<p>iptables -t nat -A PREROUTING -d 211.101.46.253 -j DROP</p>

<p>eth2 外网网卡<br />
wlan2 是内网网卡 我们要使用 iptables 从 eth2 转发数据包的接口</p>

<h1 id="forward-wlan2-eth2">FORWARD wlan2 --&gt; eth2</h1>

<p>iptables -A FORWARD -i wlan2 -o eth2 -j ACCEPT<br />
iptables -A FORWARD -i eth2 -o wlan2 -m state --state ESTABLISHED,RELATED  -j ACCEPT</p>

<h1 id="nat-修改发送到互联网的数据包的源地址为-eth2">NAT 修改发送到互联网的数据包的源地址为 eth2</h1>

<p>iptables -t nat -A POSTROUTING -o eth2 -j MASQUERADE</p>

<p>#<br />
代理服务器WAN IP：111.<strong>.</strong>.219,LAN IP：192.168.0.219<br />
内网服务器IP：192.168.0.41<br />
iptables -t nat -A PREROUTING -d 111.<strong>.</strong>.219 -p tcp --dport 9999 -j DNAT --to-destination 192.168.0.41:9999</p>

<p>iptables -t nat -A POSTROUTING -d 192.168.0.41 -p tcp --dport 9999 -j SNAT --to-source 192.168.0.219</p>

<h2 id="vpn-pptp-ipsec-nat-策略">VPN PPTP IPSEC NAT 策略</h2>

<p>iptables -t nat -A PREROUTING -p tcp --dport 80 -d $INTERNET_ADDR -j DNAT --to-destination 192.168.100.2:80<br />
iptables -t nat -A PREROUTING -p tcp --dport 1723 -d $INTERNET_ADDR -j DNAT --to-destination 192.168.100.2:1723<br />
iptables -t nat -A PREROUTING -p udp --dport 1723 -d $INTERNET_ADDR -j DNAT --to-destination 192.168.100.2:1723<br />
iptables -t nat -A PREROUTING -p udp --dport 500 -d $INTERNET_ADDR -j DNAT --to-destination 192.168.100.2:500<br />
iptables -t nat -A PREROUTING -p udp --dport 4500 -d $INTERNET_ADDR -j DNAT --to-destination 192.168.100.2:4500</p>

<p>FTP服务器的NAT<br />
iptables -I PFWanPriv -p tcp --dport 21 -d 192.168.100.200 -j ACCEPT<br />
iptables -t nat -A PREROUTING -p tcp --dport 21 -d $INTERNET_ADDR -j DNAT --to-destination 192.168.100.200:21</p>

<h2 id="服务">############################### 服务 ###########################################</h2>

<p>SSH=22<br />
FTP=20,21<br />
DNS=53<br />
SMTP=25,465,587<br />
POP3=110,995<br />
IMAP=143,993<br />
HTTP=80,443<br />
IDENT=113<br />
NTP=123<br />
MYSQL=3306<br />
NET_BIOS=135,137,138,139,445</p>

<h2 id="dhcp-67-68">DHCP=67,68</h2>

<h2 id="ssh-端口">ssh 端口</h2>

<p>#只对内网用户开放sshd服务<br />
[root@localhost]# iptables -A INPUT -p tcp -s 192.168.138.0/24 --dport 22 -j ACCEPT</p>

<h1 id="3-允许远程主机进行ssh连接">3.允许远程主机进行SSH连接</h1>

<p>iptables -A INPUT -i eth0 -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT<br />
iptables -A OUTPUT -o eth0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT</p>

<h1 id="4-允许本地主机进行ssh连接">4.允许本地主机进行SSH连接</h1>

<p>iptables -A OUTPUT -o eth0 -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT<br />
iptables -A INPUT -i eth0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT</p>

<h1 id="5-允许http请求">5.允许HTTP请求</h1>

<p>iptables -A INPUT -i eth0 -p tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPT<br />
iptables -A OUTPUT -o eth0 -p tcp --sport 80 -m state --state ESTABLISHED -j ACCEPT</p>

<h1 id="load-ftp-kernel-modules"># Load FTP Kernel modules</h1>

<h1 id="sbin-modprobe-ip-conntrack-ftp">/sbin/modprobe ip_conntrack_ftp</h1>

<h1 id="sbin-modprobe-ip-nat-ftp">/sbin/modprobe ip_nat_ftp</h1>

<h1 id="ftp-service"># FTP Service</h1>

<h1 id="sbin-iptables-a-input-p-tcp-dport-21-j-accept">/sbin/iptables -A INPUT -p tcp --dport 21 -j ACCEPT</h1>

<p>###recent模块阻止SSH字典攻击</p>

<pre><code># Prevent SSH Attack
iptables -A INPUT -i eth0 -p tcp --dport 22 -m state --state NEW -m recent --set --name SSH
iptables -A INPUT -i eth0 -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 60 --hitcount 3 --name SSH -j DROP
# Enable Normal SSH Connection
iptables -A INPUT -p tcp -m state --state NEW --dport 22 -j ACCEPT
</code></pre>

<p>允许所有SSH连接请求</p>

<p>本规则允许所有来自外部的SSH连接请求,也就是说,只允许进入eth0接口,并且目的端口为22的数据包</p>

<p>iptables -A INPUT -i eth0 -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT<br />
iptables -A OUTPUT -o eth0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT</p>

<p>允许从本地发起的SSH连接</p>

<p>本规则和上述规则有所不同,本规则意在允许本机发起SSH连接,上面的规则与此正好相反。</p>

<p>iptables -A OUTPUT -o eth0 -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT<br />
iptables -A INPUT -i eth0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT</p>

<p>仅允许来自指定网络的SSH连接请求</p>

<p>以下规则仅允许来自192.168.100.0/24的网络：</p>

<p>iptables -A INPUT -i eth0 -p tcp -s 192.168.100.0/24 --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT<br />
iptables -A OUTPUT -o eth0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT</p>

<p>上例中,你也可以使用-s 192.168.100.0/255.255.255.0作为网络地址。当然使用上面的CIDR地址更容易让人明白。<br />
仅允许从本地发起到指定网络的SSH连接请求</p>

<p>以下规则仅允许从本地主机连接到192.168.100.0/24的网络：</p>

<p>iptables -A OUTPUT -o eth0 -p tcp -d 192.168.100.0/24 --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT<br />
iptables -A INPUT -i eth0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT</p>

<p>7、使用iptables允许特定的主机连接<br />
 <code>iptables -A INPUT -p tcp -m state --state NEW --source 123.132.252.42,123.132.226.66 --dport 22 -j ACCEPT</code><br />
 <code>iptables -A INPUT -p tcp --dport 22 -j DROP</code><br />
 并确保没有其他的主机可以访问SSH服务：</p>

<p>8、SSH时间锁定技巧<br />
你可以使用不同的iptables参数来限制到SSH服务的连接,让其在一个特定的时间范围内可以连接,其他时间不能连接。你可以在下面的任何例子中使用/second、/minute、/hour或/day开关。<br />
第一个例子,如果一个用户输入了错误的密码,锁定一分钟内不允许在访问SSH服务,这样每个用户在一分钟内只能尝试一次登陆：<br />
 <code>iptables -A INPUT -p tcp -m state --syn --state NEW --dport 22 -m limit --limit 1/minute --limit-burst 1 -j ACCEPT</code><br />
 <code>iptables -A INPUT -p tcp -m state --syn --state NEW --dport 22 -j DROP</code><br />
第二个例子,设置iptables只允许主机193.180.177.13连接到SSH服务,在尝试三次失败登陆后,iptables允许该主机每分钟尝试一次登陆：<br />
 <code>iptables -A INPUT -p tcp -s 193.180.177.13 -m state --syn --state NEW --dport 22 -m limit --limit 1/minute --limit-burst 3 -j ACCEPT</code><br />
<code>iptables -A INPUT -p tcp -s 193.180.177.13 -m state --syn --state NEW --dport 22 -j DROP</code></p>

<h2 id="iptables使用multiport-添加多个不连续端口">iptables使用multiport 添加多个不连续端口</h2>

<p>iptables -A INPUT -p tcp -m multiport --dports 21:25,135:139 -j DROP<br />
iptables -A INPUT -p tcp -m multiport --dports 110,80,25,445,1863,5222 -j ACCEPT<br />
iptables -A INPUT -i eth0 -p tcp -m multiport --dports 22,80,443 -m state --state NEW,ESTABLISHED -j ACCEPT<br />
iptables -A OUTPUT -o eth0 -p tcp -m multiport --sports 22,80,443 -m state --state ESTABLISHED -j ACCEPT</p>

<p>如果不使用multiport参数,只能是添加连续的端口。<br />
如:<br />
iptables -A INPUT -p tcp –dport 21:25 -j DROP</p>

<p>而不能写成21:25,135:139</p>

<p>#squid代理的配置</p>

<p># 允许接收相关应答<br />
  iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</p>

<p># 仅允许以下入站协议<br />
  iptables -A INPUT -p tcp --dport 22 -j ACCEPT<br />
  iptables -A INPUT -p tcp --dport 3128 -j ACCEPT<br />
  iptables -A INPUT -p tcp --dport 3129 -j ACCEPT<br />
  iptables -A INPUT -p udp --dport 53 -j ACCEPT</p>

<p># 将HTTP服务重定向到3129端口,交给squid,这是透明代理的关键<br />
  iptables -t nat -A PREROUTING -p tcp -s 192.168.10.0/24 --dport 80 -j REDIRECT --to-ports 3129</p>

<p># 仅允许以下协议转发给默认路由（即外网路由器）<br />
  iptables -A FORWARD -p tcp --dport 443 -j ACCEPT</p>

<p># 默认策略<br />
  iptables -P INPUT DROP<br />
  iptables -P FORWARD DROP</p>

<p>#######################################################</p>

<pre><code class="language-sh">#!/bin/bash
##	    https://github.com/BenjyOC/firewall.git
## http://www.thegeekstuff.com/2011/06/iptables-rules-examples/
# 清空iptables规则
iptables -F
iptables -X
iptables -P INPUT ACCEPT
iptables -P OUTPUT ACCEPT
iptables -P FORWARD ACCEPT

iptables -t nat -F
iptables -t nat -X
iptables -t nat -P PREROUTING ACCEPT
iptables -t nat -P OUTPUT ACCEPT
iptables -t nat -P POSTROUTING ACCEPT

iptables -t mangle -F
iptables -t mangle -X
iptables -t mangle -P PREROUTING ACCEPT
iptables -t mangle -P INPUT ACCEPT
iptables -t mangle -P FORWARD ACCEPT
iptables -t mangle -P OUTPUT ACCEPT
iptables -t mangle -P POSTROUTING ACCEPT

iptables -t raw -F
iptables -t raw -X
iptables -t raw -P PREROUTING ACCEPT
iptables -t raw -P OUTPUT ACCEPT

# NAT

iptables -t nat -A PREROUTING -p udp -d 94.23.213.216 --dport 443 -j DNAT --to-destination 172.16.10.10
iptables -t nat -A PREROUTING -p tcp -d 94.23.213.216 --dport 51413 -j DNAT --to-destination 172.16.10.10
iptables -t nat -A PREROUTING -p tcp -d 94.23.213.216 --dport 9190 -j DNAT --to-destination 172.16.10.10
iptables -t nat -A PREROUTING -p tcp -d 94.23.213.216 --dport 2224 -j DNAT --to-destination 172.16.10.10:22
iptables -t nat -A PREROUTING -p tcp -d 94.23.213.216 --dport 80 -j DNAT --to-destination 172.16.10.20
iptables -t nat -A PREROUTING -p tcp -d 94.23.213.216 --dport 443 -j DNAT --to-destination 172.16.10.20
iptables -t nat -A PREROUTING -p tcp -d 94.23.213.216 --dport 53 -j DNAT --to-destination 172.16.10.2
iptables -t nat -A PREROUTING -p udp -d 94.23.213.216 --dport 53 -j DNAT --to-destination 172.16.10.2
iptables -t nat -A PREROUTING -p tcp -d 94.23.213.216 --dport 8080 -j DNAT --to-destination 172.16.10.201:80

iptables -t nat -A POSTROUTING -s 192.168.1.1/24 -j SNAT --to 94.23.213.216
iptables -t nat -A POSTROUTING -s 172.16.10.1/24 -j SNAT --to 94.23.213.216
iptables -t nat -A POSTROUTING -s 192.168.10.1/24 -j SNAT --to 94.23.213.216
iptables -t nat -A POSTROUTING -s 192.168.20.1/24 -j SNAT --to 94.23.213.216

GEN=&quot;DROP&quot;

# Default DROP
iptables -P INPUT $GEN
iptables -P FORWARD $GEN
iptables -P OUTPUT $GEN

# Keep establish connections
iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT

# Autoriser loopback
iptables -A INPUT -i lo -j ACCEPT
iptables -A OUTPUT -o lo -j ACCEPT

# ICMP
iptables -A INPUT -p icmp -j ACCEPT
iptables -A OUTPUT -p icmp -j ACCEPT

# SSH
iptables -A INPUT  -p tcp --dport 22 -j ACCEPT
iptables -A OUTPUT -p tcp --dport 22 -j ACCEPT

# Mail SMTP:25
iptables -A INPUT  -p tcp --dport 25 -j ACCEPT
iptables -A OUTPUT -p tcp --dport 25 -j ACCEPT
# DNS :53
iptables -A OUTPUT -p udp -o eth0 --dport 53 -j ACCEPT
iptables -A INPUT -p udp -i eth0 --sport 53 -j ACCEPT

# Rsync :873
iptables -A INPUT -i eth0 -p tcp -s 192.168.101.0/24 --dport 873 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -o eth0 -p tcp --sport 873 -m state --state ESTABLISHED -j ACCEPT

# MySQL :3306
iptables -A INPUT -i eth0 -p tcp -s 192.168.100.0/24 --dport 3306 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -o eth0 -p tcp --sport 3306 -m state --state ESTABLISHED -j ACCEPT

#  Sendmail or Postfix Traffic
iptables -A INPUT -i eth0 -p tcp --dport 25 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -o eth0 -p tcp --sport 25 -m state --state ESTABLISHED -j ACCEPT

#Allow IMAP and IMAPS
# IMAP/IMAP2 traffic.
iptables -A INPUT  -p tcp --dport 143 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -p tcp --sport 143 -m state --state ESTABLISHED -j ACCEPT

# IMAPS traffic.
iptables -A INPUT  -p tcp --dport 993 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -p tcp --sport 993 -m state --state ESTABLISHED -j ACCEPT

# POP3 :110
iptables -A INPUT  -p tcp --dport 110 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -p tcp --sport 110 -m state --state ESTABLISHED -j ACCEPT

# POP3S:995
iptables -A INPUT  -p tcp --dport 995 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -p tcp --sport 995 -m state --state ESTABLISHED -j ACCEPT

# GUI Proxmox
iptables -A INPUT -s 127.0.0.1 -p tcp --dport 8006 -j ACCEPT

iptables -A OUTPUT -p tcp --dport 80 -j ACCEPT
iptables -A OUTPUT -p tcp --dport 443 -j ACCEPT
iptables -A OUTPUT -p tcp --dport 53 -j ACCEPT
iptables -A OUTPUT -p udp --dport 53 -j ACCEPT
iptables -A INPUT -p tcp --dport 53 -j ACCEPT
iptables -A INPUT -p udp --dport 53 -j ACCEPT
iptables -A OUTPUT -p tcp --dport 21 -j ACCEPT
iptables -A INPUT -p tcp --dport 4949 -j ACCEPT

# Forward pour les VMs
iptables -A FORWARD -d 172.16.10.0/24 -p all -j ACCEPT
iptables -A FORWARD -s 172.16.10.0/24 -p all -j ACCEPT

iptables -A FORWARD -d 192.168.10.0/24 -p all -j ACCEPT
iptables -A FORWARD -s 192.168.10.0/24 -p all -j ACCEPT

# Monitoring OVH
iptables -A OUTPUT -p udp --dport 6100:6200 -j ACCEPT

#DDOS
iptables -A INPUT -p tcp --dport 80 -m limit --limit 25/minute --limit-burst 100 -j ACCEPT

exit 0

</code></pre>

<h2 id="实战-linux网关">实战 Linux网关</h2>

<p>生产环境中，Public IP 经常比较有限，Linux GateWay可以充分利用有限IP为更多的机器提供网络服务，也可以有意识地将某些服务器隐藏在后面，即可以主动获取网络资源，又避免被动访问，更加安全</p>

<h2 id="开启内核转发">开启内核转发</h2>

<p>调整内核参数 <strong>net.ipv4.ip_forward</strong> 开启转发</p>

<pre><code>[root@linux-gateway ~]# grep  forward  /etc/sysctl.conf
# Controls IP packet forwarding
net.ipv4.ip_forward = 1
[root@linux-gateway ~]#
</code></pre>

<p><strong>sysctl -p</strong> 使其生效，然后使用 <strong>sysctl -a</strong> 来进行确认</p>

<pre><code>[root@linux-gateway ~]# sysctl  -a | grep  forwarding
net.ipv4.conf.all.forwarding = 1
net.ipv4.conf.all.mc_forwarding = 0
net.ipv4.conf.default.forwarding = 1
net.ipv4.conf.default.mc_forwarding = 0
net.ipv4.conf.lo.forwarding = 1
net.ipv4.conf.lo.mc_forwarding = 0
net.ipv4.conf.em4.forwarding = 1
net.ipv4.conf.em4.mc_forwarding = 0
net.ipv4.conf.em2.forwarding = 1
net.ipv4.conf.em2.mc_forwarding = 0
net.ipv4.conf.em3.forwarding = 1
net.ipv4.conf.em3.mc_forwarding = 0
net.ipv4.conf.em1.forwarding = 1
net.ipv4.conf.em1.mc_forwarding = 0
net.ipv6.conf.all.forwarding = 0
net.ipv6.conf.all.mc_forwarding = 0
net.ipv6.conf.default.forwarding = 0
net.ipv6.conf.default.mc_forwarding = 0
net.ipv6.conf.lo.forwarding = 0
net.ipv6.conf.lo.mc_forwarding = 0
net.ipv6.conf.em1.forwarding = 0
net.ipv6.conf.em1.mc_forwarding = 0
net.ipv6.conf.em2.forwarding = 0
net.ipv6.conf.em2.mc_forwarding = 0
net.ipv6.conf.em3.forwarding = 0
net.ipv6.conf.em3.mc_forwarding = 0
net.ipv6.conf.em4.forwarding = 0
net.ipv6.conf.em4.mc_forwarding = 0
[root@linux-gateway ~]#
</code></pre>

<hr />

<h2 id="开启iptables转发">开启iptables转发</h2>

<p>查看内网网卡</p>

<pre><code>[root@linux-gateway ~]# ip a | grep 168
    inet 192.168.1.254/24 brd 192.168.1.255 scope global em1
[root@linux-gateway ~]#
</code></pre>

<p>内网网卡为 <strong>em1</strong></p>

<p>查看默认路由，与出口网卡</p>

<pre><code>[root@linux-gateway ~]# ip route | grep default
default via 180.140.110.123 dev em2
[root@linux-gateway ~]#
</code></pre>

<p>出口网卡为 <strong>em2</strong></p>

<p>方法一：直接在命令行配置</p>

<ul>
<li><strong>filter</strong> 表上接受来自 <strong>em1</strong> 的 <strong>FORWARD</strong> 请求<br /></li>

<li><p><strong>nat</strong> 表的 <strong>POSTROUTING</strong> 链上打开来自内网出口为 <strong>em2</strong> 的地址伪装，即 <strong>SNAT</strong></p>

<pre><code>[root@linux-gateway ~]# iptables -A FORWARD -i em1 -j ACCEPT
[root@linux-gateway ~]# iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o em2 -j MASQUERADE
</code></pre></li>
</ul>

<p>方法二：通过配置文件修改</p>

<p>可以在 <strong>/etc/sysconfig/iptables</strong> 中的 <strong>filter</strong> 和 <strong>nat</strong> 部分进行配置</p>

<pre><code>*nat
:PREROUTING ACCEPT [3370:177472]
:POSTROUTING ACCEPT [32:1664]
:OUTPUT ACCEPT [42:2288]
...
...
-A POSTROUTING -s 192.168.1.0/24 -o em2 -j MASQUERADE
COMMIT
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [65295:28838004]
...
...
#-A FORWARD -j REJECT --reject-with icmp-host-prohibited
-A FORWARD -i em1 -j ACCEPT
COMMIT
</code></pre>

<p>使用 <strong>/etc/init.d/iptables  reload</strong> 重新加载 <strong>iptables</strong></p>

<hr />

<h2 id="配置主机默认路由">配置主机默认路由</h2>

<p>在想要连接外网的服务器上删除原有路由，添加新路由</p>

<pre><code>[root@db-server ~]# ip route | grep default
default via 192.168.1.1 dev em1
[root@db-server ~]# ip route del default
[root@db-server ~]# ip route add default via 192.168.1.254 dev em1
</code></pre>

<p>测试连接</p>

<pre><code>[root@db-server ~]# ping www.baidu.com
PING www.a.shifen.com (58.217.200.13) 56(84) bytes of data.
64 bytes from 58.217.200.13: icmp_seq=1 ttl=51 time=7.59 ms
64 bytes from 58.217.200.13: icmp_seq=2 ttl=51 time=7.60 ms
64 bytes from 58.217.200.13: icmp_seq=3 ttl=51 time=7.65 ms
64 bytes from 58.217.200.13: icmp_seq=4 ttl=51 time=7.58 ms
64 bytes from 58.217.200.13: icmp_seq=5 ttl=51 time=7.64 ms
^C
--- www.a.shifen.com ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4621ms
rtt min/avg/max/mdev = 7.585/7.615/7.653/0.113 ms
[root@db-server ~]#
</code></pre>

<hr />

<h1 id="总结">总结</h1>

<ul>
<li><strong><code>net.ipv4.ip_forward = 1</code></strong><br /></li>
<li><strong><code>grep  forward  /etc/sysctl.conf</code></strong><br /></li>
<li><strong><code>sysctl  -a | grep  forwarding</code></strong><br /></li>
<li><strong><code>ip route | grep default</code></strong><br /></li>
<li><strong><code>iptables -A FORWARD -i em1 -j ACCEPT</code></strong><br /></li>
<li><strong><code>iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o em2 -j MASQUERADE</code></strong><br /></li>
<li><strong><code>-A POSTROUTING -s 192.168.1.0/24 -o em2 -j MASQUERADE</code></strong><br /></li>
<li><strong><code>-A FORWARD -i em1 -j ACCEPT</code></strong><br /></li>
<li><strong><code>/etc/init.d/iptables  reload</code></strong><br /></li>
<li><strong><code>ip route del default</code></strong><br /></li>
<li><strong><code>ip route add default via 192.168.1.254 dev em1</code></strong><br />
<br /></li>
</ul>

<h2 id="总体分三部">总体分三部</h2>

<ul>
<li>1.打开内核参数 <strong>net.ipv4.ip_forward</strong> 允许转发<br /></li>
<li>2.打开 <strong>filter</strong> 表 <strong>FORWARD</strong> 链内网端口的转发<br /></li>
<li>3.打开 <strong>nat</strong> 表 <strong>POSTROUTING</strong> 链的定向地址伪装<br />
<br /></li>
</ul>

<hr />

<h1 id="iptables-i-input-p-tcp-dport-80-j-drop">iptables -I INPUT -p tcp --dport 80 -j DROP</h1>

<h1 id="iptables-i-input-s-192-168-1-0-24-p-tcp-dport-80-j-accept">iptables -I INPUT -s 192.168.1.0/24 -p tcp --dport 80 -j ACCEPT</h1>

<h1 id="iptables-i-input-s-211-123-16-123-24-p-tcp-dport-80-j-accept">iptables -I INPUT -s 211.123.16.123/24 -p tcp --dport 80 -j ACCEPT</h1>

<p>iptables -I INPUT -p tcp --dport 9889 -j DROP<br />
iptables -I INPUT -s 192.168.1.0/24 -p tcp --dport 9889 -j ACCEPT<br />
如果用了NAT转发记得配合以下才能生效</p>

<p>iptables -I FORWARD -p tcp --dport 80 -j DROP<br />
iptables -I FORWARD -s 192.168.1.0/24 -p tcp --dport 80 -j ACCEPT<br />
常用的IPTABLES规则如下：</p>

<p>只能收发邮件，别的都关闭<br />
iptables -I Filter -m mac --mac-source 00:0F:EA:25:51:37 -j DROP<br />
iptables -I Filter -m mac --mac-source 00:0F:EA:25:51:37 -p udp --dport 53 -j ACCEPT<br />
iptables -I Filter -m mac --mac-source 00:0F:EA:25:51:37 -p tcp --dport 25 -j ACCEPT<br />
iptables -I Filter -m mac --mac-source 00:0F:EA:25:51:37 -p tcp --dport 110 -j ACCEPT</p>

<p>IPSEC NAT 策略<br />
iptables -I PFWanPriv -d 192.168.100.2 -j ACCEPT<br />
iptables -t nat -A PREROUTING -p tcp --dport 80 -d $INTERNET_ADDR -j DNAT --to-destination 192.168.100.2:80</p>

<p>iptables -t nat -A PREROUTING -p tcp --dport 1723 -d $INTERNET_ADDR -j DNAT --to-destination 192.168.100.2:1723</p>

<p>iptables -t nat -A PREROUTING -p udp --dport 1723 -d $INTERNET_ADDR -j DNAT --to-destination 192.168.100.2:1723</p>

<p>iptables -t nat -A PREROUTING -p udp --dport 500 -d $INTERNET_ADDR -j DNAT --to-destination 192.168.100.2:500</p>

<p>iptables -t nat -A PREROUTING -p udp --dport 4500 -d $INTERNET_ADDR -j DNAT --to-destination 192.168.100.2:4500</p>

<p>FTP服务器的NAT<br />
iptables -I PFWanPriv -p tcp --dport 21 -d 192.168.100.200 -j ACCEPT<br />
iptables -t nat -A PREROUTING -p tcp --dport 21 -d $INTERNET_ADDR -j DNAT --to-destination 192.168.100.200:21</p>

<p>只允许访问指定网址<br />
iptables -A Filter -p udp --dport 53 -j ACCEPT<br />
iptables -A Filter -p tcp --dport 53 -j ACCEPT<br />
iptables -A Filter -d www.3322.org -j ACCEPT<br />
iptables -A Filter -d img.cn99.com -j ACCEPT<br />
iptables -A Filter -j DROP</p>

<p>开放一个IP的一些端口，其它都封闭<br />
iptables -A Filter -p tcp --dport 80 -s 192.168.100.200 -d www.pconline.com.cn -j ACCEPT<br />
iptables -A Filter -p tcp --dport 25 -s 192.168.100.200 -j ACCEPT<br />
iptables -A Filter -p tcp --dport 109 -s 192.168.100.200 -j ACCEPT<br />
iptables -A Filter -p tcp --dport 110 -s 192.168.100.200 -j ACCEPT<br />
iptables -A Filter -p tcp --dport 53 -j ACCEPT<br />
iptables -A Filter -p udp --dport 53 -j ACCEPT<br />
iptables -A Filter -j DROP</p>

<p>多个端口<br />
iptables -A Filter -p tcp -m multiport --destination-port 22,53,80,110 -s 192.168.20.3 -j REJECT</p>

<p>连续端口<br />
iptables -A Filter -p tcp -m multiport --source-port 22,53,80,110 -s 192.168.20.3 -j REJECT iptables -A Filter -p tcp --source-port 2:80 -s 192.168.20.3 -j REJECT</p>

<p>指定时间上网<br />
iptables -A Filter -s 10.10.10.253 -m time --timestart 6:00 --timestop 11:00 --days Mon,Tue,Wed,Thu,Fri,Sat,Sun -j DROP<br />
iptables -A Filter -m time --timestart 12:00 --timestop 13:00 --days Mon,Tue,Wed,Thu,Fri,Sat,Sun -j ACCEPT<br />
iptables -A Filter -m time --timestart 17:30 --timestop 8:30 --days Mon,Tue,Wed,Thu,Fri,Sat,Sun -j ACCEPT</p>

<p>禁止多个端口服务<br />
iptables -A Filter -m multiport -p tcp --dport 21,23,80 -j ACCEPT</p>

<p>将WAN 口NAT到PC<br />
iptables -t nat -A PREROUTING -i $INTERNET_IF -d $INTERNET_ADDR -j DNAT --to-destination 192.168.0.1</p>

<p>将WAN口8000端口NAT到192。168。100。200的80端口<br />
iptables -t nat -A PREROUTING -p tcp --dport 8000 -d $INTERNET_ADDR -j DNAT --to-destination 192.168.100.200:80</p>

<p>MAIL服务器要转的端口<br />
iptables -t nat -A PREROUTING -p tcp --dport 110 -d $INTERNET_ADDR -j DNAT --to-destination 192.168.100.200:110<br />
iptables -t nat -A PREROUTING -p tcp --dport 25 -d $INTERNET_ADDR -j DNAT --to-destination 192.168.100.200:25</p>

<p>只允许PING 202。96。134。133,别的服务都禁止<br />
iptables -A Filter -p icmp -s 192.168.100.200 -d 202.96.134.133 -j ACCEPT<br />
iptables -A Filter -j DROP</p>

<p>禁用BT配置<br />
iptables –A Filter –p tcp –dport 6000:20000 –j DROP</p>

<p>禁用QQ防火墙配置<br />
iptables -A Filter -p udp --dport ! 53 -j DROP<br />
iptables -A Filter -d 218.17.209.0/24 -j DROP<br />
iptables -A Filter -d 218.18.95.0/24 -j DROP<br />
iptables -A Filter -d 219.133.40.177 -j DROP</p>

<p>基于MAC，只能收发邮件，其它都拒绝<br />
iptables -I Filter -m mac --mac-source 00:0A:EB:97:79:A1 -j DROP<br />
iptables -I Filter -m mac --mac-source 00:0A:EB:97:79:A1 -p tcp --dport 25 -j ACCEPT<br />
iptables -I Filter -m mac --mac-source 00:0A:EB:97:79:A1 -p tcp --dport 110 -j ACCEPT</p>

<p>禁用MSN配置<br />
iptables -A Filter -p udp --dport 9 -j DROP<br />
iptables -A Filter -p tcp --dport 1863 -j DROP<br />
iptables -A Filter -p tcp --dport 80 -d 207.68.178.238 -j DROP<br />
iptables -A Filter -p tcp --dport 80 -d 207.46.110.0/24 -j DROP</p>

<p>只允许PING 202。96。134。133 其它公网IP都不许PING<br />
iptables -A Filter -p icmp -s 192.168.100.200 -d 202.96.134.133 -j ACCEPT<br />
iptables -A Filter -p icmp -j DROP</p>

<p>禁止某个MAC地址访问internet:<br />
iptables -I Filter -m mac --mac-source 00:20:18:8F:72:F8 -j DROP</p>

<p>禁止某个IP地址的PING:<br />
iptables –A Filter –p icmp –s 192.168.0.1 –j DROP</p>

<p>禁止某个IP地址服务：<br />
iptables –A Filter -p tcp -s 192.168.0.1 --dport 80 -j DROP<br />
iptables –A Filter -p udp -s 192.168.0.1 --dport 53 -j DROP</p>

<p>只允许某些服务，其他都拒绝(2条规则)<br />
iptables -A Filter -p tcp -s 192.168.0.1 --dport 1000 -j ACCEPT<br />
iptables -A Filter -j DROP</p>

<p>禁止某个IP地址的某个端口服务<br />
iptables -A Filter -p tcp -s 10.10.10.253 --dport 80 -j ACCEPT<br />
iptables -A Filter -p tcp -s 10.10.10.253 --dport 80 -j DROP</p>

<p>禁止某个MAC地址的某个端口服务</p>

<p>iptables -I Filter -p tcp -m mac --mac-source 00:20:18:8F:72:F8 --dport 80 -j DROP</p>

<p>禁止某个MAC地址访问internet:<br />
iptables -I Filter -m mac --mac-source 00:11:22:33:44:55 -j DROP<br />
禁止某个IP地址的PING:<br />
iptables –A Filter –p icmp –s 192.168.0.1 –j DROP</p>

                        </div>                      
                        <div class="clear"></div>
                    </div>
                </div>
            </article>   
            <div class="clear"></div>

            
            <p class="post-tags">
                  <span class="fa fa-tags">Tags:</span>
                  
                    <a rel="tag" href="../../../tags/iptables">iptables</a>
                  
            </p>
            
            <div id="related-posts">
                <div class="related-inner">
                </div>
            </div>
            
            
<section id="comments" class="themeform">
  

  

  
  

<div id="gitment"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>


<script>
var gitment = new Gitment({
  
  id: location.pathname,
  owner: 'rinetd',
  repo: 'rinetd.github.io',
  oauth: {
    client_id: '89af57db85ca20b7668c',
    client_secret: '4e57a031d7bd29f740559a907db2fe0efb3bf813',
  },
})
gitment.render('gitment')
</script>

  


</section>

            
            <section id="comments" class="themeform">
                
            </section>
        </div>
</div> <div class="sidebar s1 collapsed" data-position="left" data-layout="col-3cm" data-sb-id="s1">
    <a class="sidebar-toggle" title="Expand Sidebar">
        <i class="fas icon-sidebar-toggle"></i>
    </a>
    <div class="sidebar-content">
        <div class="sidebar-top group">
            <p>Follow:</p>  
                          
<ul class="social-links">
    
    
    
    

    
    <li>
        <a class="social-tooltip" href="mailto:" title="Email">
            <i class="fa fa-envelope"></i></a>
    </li>

    
    <li>
        <a class="social-tooltip"  href="//github.com/" title="GitHub"><i
                class="fa fa-github"></i></a>
    </li>

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    
    <li>
        <a class="social-tooltip" title="RSS Feed"
            aria-label="RSS Feed"
            href="../../../feed" target="_blank"
            style="color:rgba(255,255,255,0.7)">
            <i class="fa fa-rss"></i>
        </a>
    </li>

</ul>
   
        </div>
            <ul class="post-nav group">
    <li class="previous">
      
      <a href="../../../linux/cmd/linux-systemd-timer/" rel="prev">
        <i class="fa fa-chevron-left"></i>
        <strong>Previous Post</strong>
        <span>Linux命令 Systemd中Service Timer单元介绍</span>
      </a>
      
  </li>
</ul>

            
            <div id="categories-2" class="widget widget_categories"><h3>分类</h3>
  <ul>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/ai/">Ai</a>
        <small>(4)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/algorithm/">Algorithm</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/android/">Android</a>
        <small>(17)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/ansible/">Ansible</a>
        <small>(2)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/beats/">Beats</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/caffe/">Caffe</a>
        <small>(18)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/camera/">Camera</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/cgo/">Cgo</a>
        <small>(9)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/clang/">Clang</a>
        <small>(6)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/cmd/">Cmd</a>
        <small>(2)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/cpp/">Cpp</a>
        <small>(2)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/css/">Css</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/dart/">Dart</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/database/">Database</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/dataset/">Dataset</a>
        <small>(2)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/deeplearning/">Deeplearning</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/devops/">Devops</a>
        <small>(70)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/docker/">Docker</a>
        <small>(18)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/dts/">Dts</a>
        <small>(5)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/elasticsearch/">Elasticsearch</a>
        <small>(9)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/english/">English</a>
        <small>(3)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/freertos/">Freertos</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/front-end/">Front-End</a>
        <small>(20)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/golang/">Golang</a>
        <small>(127)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/hacker/">Hacker</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/hardware/">Hardware</a>
        <small>(10)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/hisi/">Hisi</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/jetson/">Jetson</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/js/">Js</a>
        <small>(9)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/jumpserver/">Jumpserver</a>
        <small>(2)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/kernel/">Kernel</a>
        <small>(6)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/linux/">Linux</a>
        <small>(91)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/linux-%E5%91%BD%E4%BB%A4/">Linux-命令</a>
        <small>(120)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/mac/">Mac</a>
        <small>(2)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/machinelearn/">Machinelearn</a>
        <small>(3)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/machinelearning/">Machinelearning</a>
        <small>(11)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/macos/">Macos</a>
        <small>(5)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/math/">Math</a>
        <small>(6)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/matplotlib/">Matplotlib</a>
        <small>(3)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/mysql/">Mysql</a>
        <small>(10)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/ncnn/">Ncnn</a>
        <small>(3)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/network/">Network</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/nginx/">Nginx</a>
        <small>(2)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/node/">Node</a>
        <small>(3)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/numpy/">Numpy</a>
        <small>(4)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/opencv/">Opencv</a>
        <small>(10)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/pandas/">Pandas</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/platform/">Platform</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/post/">Post</a>
        <small>(2)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/pyqt/">Pyqt</a>
        <small>(4)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/python/">Python</a>
        <small>(24)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/pytorch/">Pytorch</a>
        <small>(6)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/rk3288/">Rk3288</a>
        <small>(23)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/rk3399/">Rk3399</a>
        <small>(9)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/rtmp/">Rtmp</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/scikit/">Scikit</a>
        <small>(3)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/shell/">Shell</a>
        <small>(2)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/tool/">Tool</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/weixin/">Weixin</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/windows/">Windows</a>
        <small>(22)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/work/">Work</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/yolo/">Yolo</a>
        <small>(7)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/">前端技术</a>
        <small>(3)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/%E5%8D%8F%E8%AE%AE/">协议</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/">嵌入式</a>
        <small>(23)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/%E5%B7%A5%E5%85%B7/">工具</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95/">常用算法</a>
        <small>(2)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/%E6%8E%92%E5%88%97%E7%BB%84%E5%90%88/">排列组合</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
        <small>(37)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91/">文本编辑</a>
        <small>(30)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">正则表达式</a>
        <small>(3)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/%E7%94%9F%E6%B4%BB%E6%8A%80%E5%B7%A7/">生活技巧</a>
        <small>(4)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/%E7%A8%8B%E5%BA%8F%E5%91%98/">程序员</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a>
        <small>(40)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/%E9%9B%86%E7%BE%A4%E7%9B%91%E6%8E%A7/">集群监控</a>
        <small>(7)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/">静态博客</a>
        <small>(15)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a href="../../../categories/%E9%AB%98%E6%95%B0/">高数</a>
        <small>(2)</small>
      </li>
    
  </ul>

</div>


    </div>
</div> <div class="sidebar s2 collapsed" data-position="right" data-layout="col-3cm" data-sb-id="s2">
        <a class="sidebar-toggle" title="Expand Sidebar">
            <i class="fas icon-sidebar-toggle"></i>
        </a>
        <div class="sidebar-content">
            <div class="sidebar-top group">
                <p>More</p>
            </div>
            <ul class="post-nav group">
    <li class="next">
      
      <a href="../../../linux/cmd/linux-iptables-rules/" rel="next">
        <i class="fa fa-chevron-right"></i>
        <strong>Next post</strong>
        <span>Linux命令 Iptables</span>
      </a>
      
  </li>
</ul>

            <div id="tag_cloud-2" class="widget widget_tag_cloud"><h3>标签云</h3>
  <div class="tagcloud post-tags">

      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/ai/" class="tag-link-4" title="1 Posts">ai<small>(4)</small></a>
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/ansible/" class="tag-link-19" title="1 Posts">ansible<small>(19)</small></a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/awesome/" class="tag-link-3" title="1 Posts">awesome<small>(3)</small></a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/bfc/" class="tag-link-2" title="1 Posts">bfc<small>(2)</small></a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/c/" class="tag-link-5" title="1 Posts">c<small>(5)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/caffe/" class="tag-link-18" title="1 Posts">caffe<small>(18)</small></a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/centos7/" class="tag-link-2" title="1 Posts">centos7<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/cgo/" class="tag-link-9" title="1 Posts">cgo<small>(9)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/clang/" class="tag-link-6" title="1 Posts">clang<small>(6)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/cmd/" class="tag-link-2" title="1 Posts">cmd<small>(2)</small></a>
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/cpp/" class="tag-link-2" title="1 Posts">cpp<small>(2)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/css/" class="tag-link-20" title="1 Posts">css<small>(20)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/css3/" class="tag-link-2" title="1 Posts">css3<small>(2)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/curd/" class="tag-link-3" title="1 Posts">curd<small>(3)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/curl/" class="tag-link-2" title="1 Posts">curl<small>(2)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/dataset/" class="tag-link-2" title="1 Posts">dataset<small>(2)</small></a>
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/devops/" class="tag-link-3" title="1 Posts">devops<small>(3)</small></a>
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/docker/" class="tag-link-21" title="1 Posts">docker<small>(21)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/drone/" class="tag-link-22" title="1 Posts">drone<small>(22)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/dts/" class="tag-link-6" title="1 Posts">dts<small>(6)</small></a>
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/elasticsearch/" class="tag-link-9" title="1 Posts">elasticsearch<small>(9)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/emacs/" class="tag-link-12" title="1 Posts">emacs<small>(12)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/encode/" class="tag-link-3" title="1 Posts">encode<small>(3)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/english/" class="tag-link-8" title="1 Posts">english<small>(8)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/es6/" class="tag-link-2" title="1 Posts">es6<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/etcd/" class="tag-link-4" title="1 Posts">etcd<small>(4)</small></a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/flannel/" class="tag-link-2" title="1 Posts">flannel<small>(2)</small></a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/git/" class="tag-link-6" title="1 Posts">git<small>(6)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/github/" class="tag-link-2" title="1 Posts">github<small>(2)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/golang/" class="tag-link-141" title="1 Posts">golang<small>(141)</small></a>
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/gradle/" class="tag-link-3" title="1 Posts">gradle<small>(3)</small></a>
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/haproxy/" class="tag-link-5" title="1 Posts">haproxy<small>(5)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/hardware/" class="tag-link-10" title="1 Posts">hardware<small>(10)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/hexo/" class="tag-link-3" title="1 Posts">hexo<small>(3)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/html/" class="tag-link-2" title="1 Posts">html<small>(2)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/http/" class="tag-link-6" title="1 Posts">http<small>(6)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/hugo/" class="tag-link-14" title="1 Posts">hugo<small>(14)</small></a>
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/imagemagick/" class="tag-link-2" title="1 Posts">imagemagick<small>(2)</small></a>
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/ip/" class="tag-link-3" title="1 Posts">ip<small>(3)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/iproute2/" class="tag-link-5" title="1 Posts">iproute2<small>(5)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/iptables/" class="tag-link-17" title="1 Posts">iptables<small>(17)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/javascript/" class="tag-link-19" title="1 Posts">javascript<small>(19)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/jquery/" class="tag-link-12" title="1 Posts">jquery<small>(12)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/js/" class="tag-link-10" title="1 Posts">js<small>(10)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/jumpserver/" class="tag-link-2" title="1 Posts">jumpserver<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/jwt/" class="tag-link-3" title="1 Posts">jwt<small>(3)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/kernel/" class="tag-link-6" title="1 Posts">kernel<small>(6)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/kubernetes/" class="tag-link-11" title="1 Posts">kubernetes<small>(11)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/linux/" class="tag-link-19" title="1 Posts">linux<small>(19)</small></a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/lvs/" class="tag-link-8" title="1 Posts">lvs<small>(8)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/machinelearn/" class="tag-link-3" title="1 Posts">machinelearn<small>(3)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/machinelearning/" class="tag-link-11" title="1 Posts">machinelearning<small>(11)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/macos/" class="tag-link-7" title="1 Posts">macos<small>(7)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/makefile/" class="tag-link-2" title="1 Posts">makefile<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/mariadb/" class="tag-link-9" title="1 Posts">mariadb<small>(9)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/math/" class="tag-link-6" title="1 Posts">math<small>(6)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/matplotlib/" class="tag-link-3" title="1 Posts">matplotlib<small>(3)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/maven/" class="tag-link-2" title="1 Posts">maven<small>(2)</small></a>
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/meteor/" class="tag-link-7" title="1 Posts">meteor<small>(7)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/ml/" class="tag-link-3" title="1 Posts">ml<small>(3)</small></a>
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/mysql/" class="tag-link-61" title="1 Posts">mysql<small>(61)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/ncnn/" class="tag-link-3" title="1 Posts">ncnn<small>(3)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/netns/" class="tag-link-2" title="1 Posts">netns<small>(2)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/network/" class="tag-link-2" title="1 Posts">network<small>(2)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/nginx/" class="tag-link-28" title="1 Posts">nginx<small>(28)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/nmap/" class="tag-link-2" title="1 Posts">nmap<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/node/" class="tag-link-4" title="1 Posts">node<small>(4)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/nosql/" class="tag-link-8" title="1 Posts">nosql<small>(8)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/npm/" class="tag-link-3" title="1 Posts">npm<small>(3)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/numpy/" class="tag-link-4" title="1 Posts">numpy<small>(4)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/oauth2/" class="tag-link-2" title="1 Posts">oauth2<small>(2)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/opencv/" class="tag-link-10" title="1 Posts">opencv<small>(10)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/openssl/" class="tag-link-3" title="1 Posts">openssl<small>(3)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/pandoc/" class="tag-link-2" title="1 Posts">pandoc<small>(2)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/php/" class="tag-link-4" title="1 Posts">php<small>(4)</small></a>
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/post/" class="tag-link-3" title="1 Posts">post<small>(3)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/powershell/" class="tag-link-2" title="1 Posts">powershell<small>(2)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/prometheus/" class="tag-link-8" title="1 Posts">prometheus<small>(8)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/pyqt/" class="tag-link-4" title="1 Posts">pyqt<small>(4)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/python/" class="tag-link-26" title="1 Posts">python<small>(26)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/pytorch/" class="tag-link-6" title="1 Posts">pytorch<small>(6)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/redis/" class="tag-link-2" title="1 Posts">redis<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/reflect/" class="tag-link-3" title="1 Posts">reflect<small>(3)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/responsive/" class="tag-link-2" title="1 Posts">responsive<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/restful/" class="tag-link-6" title="1 Posts">restful<small>(6)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/rk3288/" class="tag-link-22" title="1 Posts">rk3288<small>(22)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/rk3399/" class="tag-link-9" title="1 Posts">rk3399<small>(9)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/route/" class="tag-link-2" title="1 Posts">route<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/rsync/" class="tag-link-2" title="1 Posts">rsync<small>(2)</small></a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/scikit/" class="tag-link-3" title="1 Posts">scikit<small>(3)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/scrapy/" class="tag-link-8" title="1 Posts">scrapy<small>(8)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/scss/" class="tag-link-2" title="1 Posts">scss<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/sed/" class="tag-link-3" title="1 Posts">sed<small>(3)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/seo/" class="tag-link-5" title="1 Posts">seo<small>(5)</small></a>
        
      
        
      
        
          <a rel="tag" href="../../../tags/shell/" class="tag-link-10" title="1 Posts">shell<small>(10)</small></a>
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/sqlite/" class="tag-link-2" title="1 Posts">sqlite<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/ssh/" class="tag-link-3" title="1 Posts">ssh<small>(3)</small></a>
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/stm32/" class="tag-link-5" title="1 Posts">stm32<small>(5)</small></a>
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/swagger/" class="tag-link-2" title="1 Posts">swagger<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/swarm/" class="tag-link-2" title="1 Posts">swarm<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/sysbench/" class="tag-link-2" title="1 Posts">sysbench<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/sysctl/" class="tag-link-2" title="1 Posts">sysctl<small>(2)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/systemctl/" class="tag-link-2" title="1 Posts">systemctl<small>(2)</small></a>
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/tc/" class="tag-link-2" title="1 Posts">tc<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/tcpdump/" class="tag-link-2" title="1 Posts">tcpdump<small>(2)</small></a>
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/timezone/" class="tag-link-2" title="1 Posts">timezone<small>(2)</small></a>
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/tshark/" class="tag-link-2" title="1 Posts">tshark<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/ubuntu/" class="tag-link-2" title="1 Posts">ubuntu<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/ulimit/" class="tag-link-2" title="1 Posts">ulimit<small>(2)</small></a>
        
      
        
      
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/vim/" class="tag-link-14" title="1 Posts">vim<small>(14)</small></a>
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/webpack3/" class="tag-link-2" title="1 Posts">webpack3<small>(2)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/windows/" class="tag-link-18" title="1 Posts">windows<small>(18)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/wireshark/" class="tag-link-2" title="1 Posts">wireshark<small>(2)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/xidel/" class="tag-link-2" title="1 Posts">xidel<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/xml/" class="tag-link-2" title="1 Posts">xml<small>(2)</small></a>
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/yaml/" class="tag-link-2" title="1 Posts">yaml<small>(2)</small></a>
        
      
        
          <a rel="tag" href="../../../tags/yolo/" class="tag-link-7" title="1 Posts">yolo<small>(7)</small></a>
        
      
        
      
        
      
        
      
        
          <a rel="tag" href="../../../tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" class="tag-link-2" title="1 Posts">微服务<small>(2)</small></a>
        
      
        
      
        
      
        
      
  </div>
</div>


        </div>
    </div>`

                    </div>
                    
                </div>
                

            </div>

        </div>
    </div>

    <footer id="footer">
    <section class="container" id="footer-bottom">
      <div class="container-inner">
        <a id="back-to-top" href="#"><i class="fa fa-angle-up"></i></a>
        <div class="pad group">
          <div class="grid one-half">
            <div id="copyright">
                <p>Copyright (c) 2017. All rights reserved. (版权所有) <a href='http://www.miitbeian.gov.cn/'>鲁ICP备17074587号-1</a></p>
                
            </div>
            
          </div>
          
          <div class="grid one-half last">
            <ul class="social-links">
    <li>
    <a class="social-tooltip" title="On WeiBo"
        href="http://weibo.com/rinetd" target="_blank">
        <i class="fa fa-weibo"></i>
    </a>
    </li>
    <li>
    <a class="social-tooltip" title="On Twitter"
        href="https://twitter.com/rinetd" target="_blank">
        <i class="fa fa-twitter"></i>
    </a>
    </li>
    <li>
    <a class="social-tooltip" title="On GitHub"
        href="https://github.com/rinetd" target="_blank">
        <i class="fa fa-github"></i>
    </a>
    </li>
</ul>

          </div>
        </div>
  
      </div>
      
    </section>
    
  </footer>


<div class="back-to-top" id="back-to-top">
    <i class="fa fa-angle-double-up"></i>
</div>





<script type='text/javascript'>
    var HUParams={
        "_disabled":[],
        "SmoothScroll":{
            "Enabled":true,
            "Options":{"touchpadSupport":false}
        },
        "centerAllImg":"1",
        "timerOnScrollAllBrowsers":"1",
        "extLinksStyle":"1",
        "extLinksTargetExt":"1",
        "extLinksSkipSelectors":{
            "classes":["btn","button"],"ids":[]
        },
        "imgSmartLoadEnabled":"1",
        "imgSmartLoadOpts":{
            "parentSelectors":[".container .content",".container .sidebar","#footer","#header-widgets"],
            "opts":{
                "excludeImg":[".tc-holder-img"],
                "fadeIn_options":100
            }
        },
        "goldenRatio":"1.618","gridGoldenRatioLimit":"350",
        "sbStickyUserSettings":{"desktop":true,"mobile":true},
        "isWPMobile":"",
        "menuStickyUserSettings":{
            "desktop":"stick_up",
            "mobile":"stick_up"
        },
        "isDevMode":"",
        "ajaxUrl":"https:\/\/demo-hueman.presscustomizr.com\/?huajax=1",
            "frontNonce":{"id":"HuFrontNonce","handle":"798e5956c0"},
            "userStarted":{"with":"before|1.0.4","on":{"date":"2017-05-22 16:30:22.000000","timezone_type":3,"timezone":"UTC"}},
            "isWelcomeNoteOn":"","welcomeContent":""};
</script>



<script src="https://cdn.bootcss.com/lodash-compat/3.10.2/lodash.min.js"></script>
<script src="https://cdn.bootcss.com/jquery/1.9.0/jquery.min.js"></script>
<script type="text/javascript" src="../../../front/js/scripts.js"></script> 




<script>
  $(".topbar-toggle-down").click(function(){
    $("#nav-topbar").css("overflow","visible");
  });
</script>





















<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-106129999-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    
    <noscript>
        <iframe src="//www.googletagmanager.com/ns.html?id=GTM-5HM5XM2" height="0" width="0"
                style="display:none;visibility:hidden"></iframe>
    </noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5HM5XM2');
    </script>
    
<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?e2103759b6030b3c4ac84c63c542e493";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>




</body>

</html>