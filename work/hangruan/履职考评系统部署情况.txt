# I。履职系统内网：
## 内网部署情况： 
注意事项：
1. 所有对 15.段对访问必须从内网进行
2. 所有对 61 段对访问必须从中央编办服务器进行

映射情况：
61.133.111.76:3002 # 15.14.12.152:3009
61.133.111.76:3003 # 15.14.12.152:3306
61.133.111.76:3004 # 15.14.12.153:3006


服务器分布：ssh 端口22 用户root 密码 HR2018!!
15.14.12.150: nginx
15.14.12.151: tomcat
15.14.12.152： mysql  
15.14.12.153: lzkpbi
15.14.12.154: redis

### 内网项目分布情况
1. VUE前端 
部署服务器 15.14.12.150  
部署位置 ： /docker/bianban/lotus

### 2. lzkpv4 后台 和 backendv4 后台见下表
HTTP_PORT 对应 lzkpv4端口
ADMIN_PORT 对应 backendv4 端口

**以下可保存成 cvs 格式在 excel文件中打开**

NAME,HTTP_PORT,SSH_HOST,SSH_PORT,ADMIN_PORT,ADMIN_SSH_HOST,ADMIN_SSH_PORT,DB_HOST,DB_PORT,DB_USER,DB_PASSWORD,DB_DATABASE,REDIS_HOST,REDIS_PASSWORD,REDIS_DB
shizhi,10040,15.14.12.151,22,1301,15.14.12.151,22,15.14.12.152,3306,lzkp,yqhtfjzm,shizhi,15.14.12.154,hangruan2018,0
lanshan,10040,15.14.12.151,22,1302,15.14.12.151,22,15.14.12.152,3306,lzkp,yqhtfjzm,lanshan,15.14.12.154,hangruan2018,1
luozhuang,10040,15.14.12.151,22,1311,15.14.12.151,22,15.14.12.152,3306,lzkp,yqhtfjzm,luozhuang,15.14.12.154,hangruan2018,2
hedong,10040,15.14.12.151,22,1312,15.14.12.151,22,15.14.12.152,3306,lzkp,yqhtfjzm,hedong,15.14.12.154,hangruan2018,3
gaoxinqu,10040,15.14.12.151,22,1313,15.14.12.151,22,15.14.12.152,3306,lzkp,yqhtfjzm,gaoxinqu,15.14.12.154,hangruan2018,4
jingkaiqu,10040,15.14.12.151,22,1314,15.14.12.152,22,15.14.12.152,3306,lzkp,yqhtfjzm,jingkaiqu,15.14.12.154,hangruan2018,5
lingang,10040,15.14.12.151,22,1315,15.14.12.152,22,15.14.12.152,3306,lzkp,yqhtfjzm,lingang,15.14.12.154,hangruan2018,6
yinan,10040,15.14.12.151,22,1321,15.14.12.152,22,15.14.12.152,3306,lzkp,yqhtfjzm,yinan,15.14.12.154,hangruan2018,7
tancheng,10040,15.14.12.151,22,1322,15.14.12.152,22,15.14.12.152,3306,lzkp,yqhtfjzm,tancheng,15.14.12.154,hangruan2018,8
yishui,10040,15.14.12.151,22,1323,15.14.12.153,22,15.14.12.152,3306,lzkp,yqhtfjzm,yishui,15.14.12.154,hangruan2018,9
lanling,10040,15.14.12.151,22,1324,15.14.12.153,22,15.14.12.152,3306,lzkp,yqhtfjzm,lanling,15.14.12.154,hangruan2018,10
feixian,10040,15.14.12.151,22,1325,15.14.12.153,22,15.14.12.152,3306,lzkp,yqhtfjzm,feixian,15.14.12.154,hangruan2018,11
pingyi,10040,15.14.12.151,22,1326,15.14.12.153,22,15.14.12.152,3306,lzkp,yqhtfjzm,pingyi,15.14.12.154,hangruan2018,12
junan,10040,15.14.12.151,22,1327,15.14.12.153,22,15.14.12.152,3306,lzkp,yqhtfjzm,junan,15.14.12.154,hangruan2018,13
mengyin,10040,15.14.12.151,22,1328,15.14.12.154,22,15.14.12.152,3306,lzkp,yqhtfjzm,mengyin,15.14.12.154,hangruan2018,14
linshu,10040,15.14.12.151,22,1329,15.14.12.154,22,15.14.12.152,3306,lzkp,yqhtfjzm,linshu,15.14.12.154,hangruan2018,15

### lzkpbi
部署服务器 15.14.12.153  
部署位置 ： /docker/tomcat/webapps/lzkpbi

### etl
部署服务器：15.14.12.153
计划任务：`0 4,13 * * * sh /root/shetl/etl.sh`
etl部署位置： /root/shetl/
etl程序：/usr/local/data-integration

# II。履职考评系统中央编办外网 
 外网系统通过VPN进行访问
 VPN地址： https://111.235.181.216
  VPN账号密码 linyibb/Conac@123
服务器为 Centos7.4 用户 root 密码 HR2018

vpn地址             服务器内网地址
172.26.96.173       10.114.0.
172.26.96.174       10.114.0.
172.26.96.175       10.114.0.
172.26.96.176       10.114.0.
172.26.96.177       10.114.0.
172.26.96.178       10.114.0.
172.26.96.179       10.114.0.
172.26.96.180       10.114.0.
172.26.96.181       10.114.0.
172.26.96.182       10.114.0.
172.26.96.183       10.114.0.
172.26.96.184       10.114.0.
172.26.96.185       10.114.0.
172.26.96.186       10.114.0.
172.26.96.187       10.114.0.

### 1. nginx 系统入口
外网地址： 111.235.181.126
内网地址： 10.114.0.2

nginx配置文件 /etc/nginx/... 和 /docker/bianban/nginx/...

## 数据库 
帐号root 密码：toor
使用帐号： lzkp 密码 yqhtfjzm
主库 10.114.0.10  
从库 10.114.0.11

### 2. lzkpv4 后台 和 backendv4 后台
HTTP_PORT 对应 lzkpv4端口
ADMIN_PORT 对应 backendv4 端口
**以下可保存成 cvs 格式在 excel文件中打开**
NAME,HTTP_PORT,SSH_HOST,SSH_PORT,ADMIN_PORT,ADMIN_SSH_HOST,ADMIN_SSH_PORT,DB_HOST,DB_PORT,DB_USER,DB_PASSWORD,DB_DATABASE,REDIS_HOST,REDIS_PASSWORD,REDIS_DB
shizhi,10040,10.114.0.3,22,1301,10.114.0.11,22,10.114.0.10,3306,lzkp,yqhtfjzm,shizhi,10.114.0.5,hangruan2018,0
lanshan,10040,10.114.0.3,22,1302,10.114.0.12,22,10.114.0.10,3306,lzkp,yqhtfjzm,lanshan,10.114.0.5,hangruan2018,1
luozhuang,10040,10.114.0.3,22,1311,10.114.0.13,22,10.114.0.10,3306,lzkp,yqhtfjzm,luozhuang,10.114.0.5,hangruan2018,2
hedong,10040,10.114.0.3,22,1312,10.114.0.14,22,10.114.0.10,3306,lzkp,yqhtfjzm,hedong,10.114.0.5,hangruan2018,3
gaoxinqu,10040,10.114.0.3,22,1313,10.114.0.15,22,10.114.0.10,3306,lzkp,yqhtfjzm,gaoxinqu,10.114.0.5,hangruan2018,4
jingkaiqu,10040,10.114.0.3,22,1314,10.114.0.16,22,10.114.0.10,3306,lzkp,yqhtfjzm,jingkaiqu,10.114.0.5,hangruan2018,5
lingang,10040,10.114.0.3,22,1315,10.114.0.17,22,10.114.0.10,3306,lzkp,yqhtfjzm,lingang,10.114.0.5,hangruan2018,6
yinan,10040,10.114.0.3,22,1321,10.114.0.18,22,10.114.0.10,3306,lzkp,yqhtfjzm,yinan,10.114.0.5,hangruan2018,7
tancheng,10040,10.114.0.3,22,1322,10.114.0.11,22,10.114.0.10,3306,lzkp,yqhtfjzm,tancheng,10.114.0.5,hangruan2018,8
yishui,10040,10.114.0.3,22,1323,10.114.0.12,22,10.114.0.10,3306,lzkp,yqhtfjzm,yishui,10.114.0.5,hangruan2018,9
lanling,10040,10.114.0.3,22,1324,10.114.0.13,22,10.114.0.10,3306,lzkp,yqhtfjzm,lanling,10.114.0.5,hangruan2018,10
feixian,10040,10.114.0.3,22,1325,10.114.0.14,22,10.114.0.10,3306,lzkp,yqhtfjzm,feixian,10.114.0.5,hangruan2018,11
pingyi,10040,10.114.0.3,22,1326,10.114.0.15,22,10.114.0.10,3306,lzkp,yqhtfjzm,pingyi,10.114.0.5,hangruan2018,12
junan,10040,10.114.0.3,22,1327,10.114.0.16,22,10.114.0.10,3306,lzkp,yqhtfjzm,junan,10.114.0.5,hangruan2018,13
mengyin,10040,10.114.0.3,22,1328,10.114.0.17,22,10.114.0.10,3306,lzkp,yqhtfjzm,mengyin,10.114.0.5,hangruan2018,14
linshu,10040,10.114.0.3,22,1329,10.114.0.18,22,10.114.0.10,3306,lzkp,yqhtfjzm,linshu,10.114.0.5,hangruan2018,15
mengshan,10040,10.114.0.3,22,1330,10.114.0.18,22,10.114.0.10,3306,lzkp,yqhtfjzm,mengshan,10.114.0.5,hangruan2018,0

### lzkpbi 
服务器 10.114.0.13 端口：10051
部署位置 /docker/tomcat/lzkpbi/

### etl 
第一部分 数据归集 
功能介绍： 
1. etl 是用来做编办系统数据汇集的
运行场景： 线上服务器
操作数据库： 县区数据库+ lzkpbi
工作原理是对个县区数据库抽取，并插入到lzkpbi数据库中。
执行的方式是通过linux 计划任务运行。

2. etl 部署在服务器 10.114.0.5分3部分 
   a. etl的运行环境kattle 部署在 /usr/local/data-integration
   b. etl程序源文件 /root/etl 目录下 （数据抽取功能）
   c. etl执行脚本 /root/shetl/etl.sh (统计数据的更新)
3. 
计划任务：`0 4,13 * * * sh /root/shetl/etl.sh`
etl部署位置： /root/shetl/
etl程序：/usr/local/data-integration


第二部分 数据合并 （这个kattle程序由于数据库结构变更应该已经不能使用了，需要修改 源文件在 10.114.0.5：/root/etl_bi/ 目录下）
功能介绍：
运行场景： 本地机器 （推荐）
操作数据库  lzkpbi
使用步骤：
1. 将内外网的lzkpbi库分别在本地机器恢复
2. 使用etl_bi源文件 进行内外网合并操作生成公有的lzkpbi库
3. 线上恢复 本地生成的lzkpbi库
4. 执行线上lzkpbi统计数重新生成
5. 将线上的lzkpbi库恢复到内网

etl_bi源文件 仅用来处理统计数据的合并，如果涉及到业务及字段修改需要重新开发
